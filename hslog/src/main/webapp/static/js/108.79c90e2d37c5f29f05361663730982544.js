webpackJsonp([108],{B9NE:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("iIsE"),i=a("58QH"),r=a("8+FI"),s=a("/sA3"),u={name:"urlRanking",data:function(){return{loading:!1,rankingTitle:"URL Top10 排行",rankingData:[],busName:"urlRanking",dateBusName:"",application_layer_protocol:"",ipv4_dst_addr:"",timepicker:[],currentItemVal:"",selectedMenuState:!1,menuLeft:"",menuTop:""}},computed:{menuLocation:function(){return{top:this.menuTop+"px",left:this.menuLeft+"px"}}},created:function(){var t=this;if(this.$route.query.val)this.timepicker=[this.$route.query.starttime,this.$route.query.endtime];else{var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),this.timepicker=[Object(s.e)("yyyy-mm-dd HH:MM:SS",a),Object(s.e)("yyyy-mm-dd HH:MM:SS",e)]}this.dateBusName="urlRankingDateBusName"+this.$route.query.val,r.default.$on(this.dateBusName,function(e){t.timepicker=e,t.getRankingData(t.timepicker)})},mounted:function(){Object(s.j)($(".ranking-wapper"))},beforeDestroy:function(){r.default.$off(this.busName),r.default.$off(this.dateBusName)},methods:{getRankingData:function(t){var e=this;this.loading=!0,this.$nextTick(function(){e.$route.query.val&&(e.application_layer_protocol="http",e.ipv4_dst_addr=e.$route.query.val,e.rankingTitle=e.$route.query.val+" URL 排行",e.$options.name="urlRanking"+e.$route.query.val,e.busName="urlRanking"+e.$route.query.val),e.$axios.post(e.$baseUrl+"/flow/getCountGroupByUrl.do",e.$qs.stringify({application_layer_protocol:e.application_layer_protocol,ipv4_dst_addr:e.ipv4_dst_addr,starttime:t[0],endtime:t[1]})).then(function(t){e.loading=!1;var a=[];t.data.forEach(function(t){var e={};e.text=t.domain_url,e.count=t.count,a.push(e)}),e.rankingData=a}).catch(function(t){e.loading=!1,layer.msg("获取数据失败",{icon:5})})})},rankingMenu:function(){var t={};t.val=this.currentItemVal,t.starttime=this.timepicker[0],t.endtime=this.timepicker[1],Object(s.l)("funcRanking"+this.currentItemVal,"logsManage/funcRanking.vue",t,"排行")},graphMenu:function(){var t={};t.val=this.currentItemVal,t.starttime=this.timepicker[0],t.endtime=this.timepicker[1],Object(s.l)("urlGraph"+this.currentItemVal,"logsManage/urlGraph.vue",t,"业务流")},timepickerChange:function(){null===this.timepicker&&(this.timepicker=["",""]),this.getRankingData(this.timepicker)}},beforeRouteEnter:function(t,e,a){a(function(e){t.query.val&&(e.busName="urlRanking"+t.query.val),r.default.$on(e.busName,function(t){e.selectedMenuState=!0,e.menuLeft=t.menuLeft,e.menuTop=t.menuTop,e.currentItemVal=t.text}),Object(s.m)(t.name,"logsManage/urlRanking.vue","排行")})},components:{vRanking:n.default,baseDate:i.default}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"content-bg",attrs:{"element-loading-background":"rgba(26,36,47, 0.2)"}},[a("div",{staticClass:"top-title"},[t._v(t._s(t.ipv4_dst_addr)+" 应用画像\n        "),a("div",{staticClass:"datepicker-wapper",staticStyle:{"padding-left":"20px",float:"right","margin-right":"10px"}},[a("baseDate",{attrs:{type:"datetimerange",busName:this.dateBusName,defaultVal:this.timepicker}})],1)]),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"ranking-wapper"},[a("v-ranking",{attrs:{title:t.rankingTitle,rankingArr:t.rankingData,busName:t.busName}})],1)]),t._v(" "),t.selectedMenuState?a("div",{staticClass:"zz",on:{click:function(e){t.selectedMenuState=!1}}},[a("div",{staticClass:"selected-menu animated bounceIn",style:t.menuLocation},[a("div",{staticClass:"menu-ranking",on:{click:t.rankingMenu}},[t._v("排行榜")]),t._v(" "),a("div",{staticClass:"men-graph",on:{click:t.graphMenu}},[t._v("业务流")]),t._v(" "),a("div",{staticClass:"menu-cancle",on:{click:function(e){t.selectedMenuState=!1}}},[t._v("取消")])])]):t._e()])},staticRenderFns:[]};var c=a("VU/8")(u,o,!1,function(t){a("Dtoj")},"data-v-10e5b266",null);e.default=c.exports},Dtoj:function(t,e){}});