webpackJsonp([51],{hK6z:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("ID1p"),i=s("8+FI"),o=s("/sA3"),n={name:"assetGroup",data:function(){return{loading:!1,busName:"assetGroupFrom",formConditionsArr:[{label:"资产组名称",paramName:"asset_group_name",model:{model:""},itemType:"",type:"input"},{label:"区域",paramName:"asset_group_area",model:{model:""},itemType:"",type:"input"},{label:"负责人",paramName:"asset_group_person",model:{model:""},itemType:"",type:"input"}],assetGroupList:[],conditionFrom:{asset_group_area:"",asset_group_name:"",asset_group_person:""},chartsloading:!1,dashboardList:[],page:1,c_page:1,size:15,allCounts:0,checkList:[]}},created:function(){var t=this;this.getAssetGroup(this.conditionFrom,1),i.default.$on(this.busName,function(e){t.conditionFrom=e,t.getAssetGroup(t.conditionFrom,1),t.c_page=1})},beforeDestroy:function(){i.default.$off(this.busName)},methods:{goToAddAssetGroup:function(){this.$router.push({path:"addAssetGroup"})},goToEditAssetGroup:function(t){Object(o.l)("editAssetGroup"+t.asset_group_id,"assetGroup/editAssetGroup.vue",{name:t.asset_group_name,id:t.asset_group_id},"资产组修改")},getAssetGroupCharts:function(t){var e=this;this.$nextTick(function(){e.dashboardList=[],e.chartsloading=!0,e.$axios.post(e.$baseUrl+"/assetGroup/getDashboardsInfo.do ",e.$qs.stringify({asset_group_id:t.asset_group_id})).then(function(t){e.chartsloading=!1;var s=t.data;"true"===s.success?e.dashboardList=s.data:layer.msg(s.message,{icon:5})}).catch(function(t){e.chartsloading=!1})})},goToDashboard:function(t,e,s){"siem"===s?Object(o.l)("equipmentSIEM"+t.asset_group_id,"equipment/equipmentSIEM.vue",{name:t.asset_group_name,id:t.asset_group_id},"查看"):Object(o.l)("assetGroupDashboard"+t.asset_group_id,"dashboard/dashboard.vue",{name:t.asset_group_name+"统计",eid:t.asset_group_id,id:e,type:"assetGroupEdit"},"查看")},refresh:function(){this.c_page=1,this.getAssetGroup(this.conditionFrom,1)},getAssetGroup:function(t,e){var s=this;this.loading=!0;var a=t;a.pageIndex=e,a.pageSize=this.size,this.$nextTick(function(){s.loading=!0,s.$axios.post(s.$baseUrl+"/assetGroup/getAssetGroupInfoByCondition.do",s.$qs.stringify(a)).then(function(t){s.loading=!1,s.loading=!1;var e=t.data;"true"===e.success?(s.allCounts=Number(e.data.count),s.assetGroupList=e.data.list):layer.msg(e.message,{icon:5})}).catch(function(t){s.loading=!1})})},removeAssetGroup:function(t){var e=this;layer.confirm("您确定删除么？",{btn:["确定","取消"]},function(s){e.loading=!0,e.$nextTick(function(){e.$axios.post(e.$baseUrl+"/assetGroup/delete.do",e.$qs.stringify({asset_group_id:t})).then(function(t){e.loading=!1,"true"==t.data.success?(layer.msg("删除成功",{icon:1}),e.c_page=1,e.getAssetGroup(e.conditionFrom,1)):layer.msg(t.data.message,{icon:5})}).catch(function(t){e.loading=!1,layer.msg("删除失败",{icon:5})})})},function(){layer.close()})},removeGroup:function(){var t=this,e="";for(var s in this.checkList)e+=this.checkList[s]+",";layer.confirm("您确定删除么？",{btn:["确定","取消"]},function(s){t.loading=!0,t.$nextTick(function(){t.$axios.post(t.$baseUrl+"/assetGroup/delete.do",t.$qs.stringify({asset_group_ids:e})).then(function(e){t.loading=!1,"true"==e.data.success?(layer.msg("删除成功",{icon:1}),t.c_page=1,t.getAssetGroup(t.conditionFrom,1)):layer.msg(e.data.message,{icon:5})}).catch(function(e){t.loading=!1,layer.msg("删除失败",{icon:5})})})},function(){layer.close()})},handleCurrentChange:function(t){this.getAssetGroup(this.conditionFrom,t)},goToEq:function(t){this.$router.push({name:"equipment_group",params:{equipmentid:t}})},goToEqGroup:function(t){this.$router.push({name:"equipment_group",params:{groupId:t}})}},components:{vSearchForm:a.default}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"content-bg",attrs:{"element-loading-background":"rgba(48, 62, 78, 0.5)"}},[s("div",{staticClass:"top-title"},[t._v("资产组\n            "),s("div",{staticClass:"btn-wapper"},[s("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:t.goToAddAssetGroup}},[t._v("添加")]),t._v(" "),s("el-button",{attrs:{type:"danger",size:"mini",plain:"",disabled:0===t.checkList.length},on:{click:t.removeGroup}},[t._v("删除")]),t._v(" "),s("el-button",{attrs:{type:"success",size:"mini",plain:""},on:{click:t.refresh}},[t._v("刷新")])],1)]),t._v(" "),s("div",{staticClass:"equipemnt-tools-form"},[s("v-search-form",{attrs:{formItem:t.formConditionsArr,busName:t.busName}})],1),t._v(" "),s("div",{staticClass:"group-wapper"},[s("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},t._l(t.assetGroupList,function(e,a){return s("div",{key:a,staticClass:"asset-item"},[s("div",{staticClass:"group-top"},[s("el-checkbox",{attrs:{label:e.asset_group_id}}),t._v(" "),s("div",{staticClass:"group-name",attrs:{title:e.asset_group_name}},[t._v(t._s(e.asset_group_name))]),t._v(" "),s("div",{staticClass:"group-btn"},[s("i",{staticClass:"el-icon-edit editGroup",attrs:{title:"修改"},on:{click:function(s){return t.goToEditAssetGroup(e)}}})]),t._v(" "),s("el-popover",{attrs:{placement:"right",width:"150",trigger:"click"}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.chartsloading,expression:"chartsloading"}],staticStyle:{"min-height":"65px"},attrs:{"element-loading-background":"rgba(48, 62, 78, 0.5)","element-loading-spinner":"el-icon-loading"}},t._l(t.dashboardList,function(a,i){return s("div",{staticClass:"eq-chart-item",on:{click:function(s){return t.goToDashboard(e,a.id,a.type)}}},[t._v("\n                                    "+t._s(a.name)+"\n                                ")])}),0),t._v(" "),s("el-button",{attrs:{slot:"reference",title:"查看报表"},on:{click:function(s){return t.getAssetGroupCharts(e)}},slot:"reference"},[s("i",{staticClass:"el-icon-s-data go_metric"})])],1)],1),t._v(" "),s("div",{staticClass:"eq-tit"},[s("span",[t._v("所在资产")]),s("span",{staticClass:"goToEqGroupSpan",attrs:{title:"查看所在资产"},on:{click:function(s){return t.goToEqGroup(e.asset_group_id)}}},[t._v("("+t._s(e.asset_group_relations.length)+")")])]),t._v(" "),s("div",{staticClass:"eq-list"},t._l(e.asset_group_relations,function(e,a){return s("div",{key:a,staticClass:"eq-item",attrs:{title:"点击查看资产信息"},on:{click:function(s){return t.goToEq(e.asset_id)}}},[t._v(t._s(e.asset_name))])}),0),t._v(" "),s("div",{staticClass:"create-time react"},[s("b",[s("i",{staticClass:"el-icon-time"}),t._v(" :")]),t._v(" "+t._s(e.create_time))]),t._v(" "),s("div",{staticClass:"group-location react"},[s("b",[s("i",{staticClass:"el-icon-location-outline"}),t._v(" :")]),t._v(" "+t._s(e.asset_group_area))]),t._v(" "),s("div",{staticClass:"group-user react"},[s("b",[s("i",{staticClass:"el-icon-user"}),t._v(" :")]),t._v(" "+t._s(e.asset_group_person))]),t._v(" "),s("div",{staticClass:"group-desc",attrs:{title:e.asset_group_note}},[s("b",[s("i",{staticClass:"el-icon-notebook-2"}),t._v(" :")]),t._v(" "+t._s(e.asset_group_note))]),t._v(" "),s("div",{staticClass:"circle-wapper"})])}),0)],1),t._v(" "),s("div",{staticClass:"equipment-table-page"},[s("span",[t._v("共检索到资产组数量为 "),s("b",[t._v(t._s(t.allCounts))]),t._v(" 个")]),t._v(" "),s("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":t.c_page,"page-size":t.size,total:t.allCounts},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.c_page=e},"update:current-page":function(e){t.c_page=e}}})],1)])},staticRenderFns:[]};var c=s("VU/8")(n,r,!1,function(t){s("iF8Y")},"data-v-6f57fb06",null);e.default=c.exports},iF8Y:function(t,e){}});