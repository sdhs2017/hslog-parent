webpackJsonp([76],{"683K":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("ID1p"),i=a("576z"),o=a("8+FI"),s=a("/sA3"),n={name:"databaseLogSearch",data:function(){return{busName:"databaseLogSearch",searchConditions:{},searchUrl:"log/getDBLogList.do",formConditionsArr:[],tableHead:[],layerObj:{detailData:{},layerState:!1},logType:[{label:"mysql",value:"mysql"},{label:"oracle",value:"oracle"},{label:"sqlserver",value:"sqlserver"}]}},created:function(){var e=this;this.tableHead=[{prop:"@timestamp",label:"时间",width:"155"},{prop:"fields.db_type",label:"日志类型",width:"100"},{prop:"fields.equipmentname",label:"资产名称",width:"125",clickFun:function(t){"unknown"===t.equipmentid?layer.msg("资产未知",{icon:5}):e.$router.push({name:"equipment2",params:{equipmentid:t.fields.equipmentid}})}},{prop:"fields.ip",label:"资产IP",width:"125"},{prop:"user",label:"数据库账号",width:"130"},{prop:"cmd",label:"操作类型",width:"70"},{prop:"rows",label:"影响行数",width:"70"},{prop:"status",label:"执行状态码",width:"85"},{prop:"query",label:"SQL语句",width:""},{prop:"tools",label:"操作",width:"60",btns:[{icon:"el-icon-tickets",text:"查看详情",btnType:"readDetails",clickFun:function(t,a){t.agent={},t.agent.type=t.fields.db_type,e.layerObj.layerState=!0,e.layerObj.detailData=t}},{icon:"el-icon-circle-close",text:"删除",btnType:"removeItem",clickFun:function(t,a){e.$refs.logContent.removeParams([t])}}]}];var t=Object(s.e)("yyyy-mm-dd HH:MM:SS",new Date),a=new Date;a.setTime(a.getTime()-864e5*this.$store.state.beforeDay),a=Object(s.e)("yyyy-mm-dd HH:MM:SS",a),this.searchConditions={endtime:t,starttime:a,"fields.db_type":"","fields.ip":"",cmd:"","fields.equipmentname":""},this.formConditionsArr=[{label:"时间范围",type:"datetimerange",itemType:"",paramName:"time",model:{model:[a,t]},val:""},{label:"日志类型",paramName:"fields.db_type",type:"select",itemType:"",model:{model:""},options:this.logType},{label:"操作类型",paramName:"cmd",type:"select",itemType:"",model:{model:""},options:[{label:"select",value:"select"},{label:"update",value:"update"},{label:"insert",value:"insert"},{label:"delete",value:"delete"}]},{label:"资产IP",paramName:"fields.ip",itemType:"",model:{model:""},type:"input"},{label:"资产名称",paramName:"fields.equipmentname",model:{model:""},itemType:"",type:"input"}],o.default.$on(this.busName,function(t){e.searchConditions=t})},beforeDestroy:function(){o.default.$off(this.busName),o.default.$off("logTypeChange"),o.default.$off("exportStart"),o.default.$off("exportFail")},methods:{getLogType:function(){var e=this;this.$nextTick(function(){e.$axios.get("static/filejson/logTypeLevel2.json",{}).then(function(t){e.logBaseJson=t.data;for(var a=0;a<t.data.length;a++){var l={value:t.data[a].type,label:t.data[a].type};e.logType.push(l)}e.setLogLevel("syslog")}).catch(function(e){console.log(e)})})}},components:{vSearchForm:l.default,vLogscontent2:i.default}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-bg"},[e._m(0),e._v(" "),a("div",{staticClass:"search-wapper"},[a("v-search-form",{attrs:{formItem:e.formConditionsArr,busName:e.busName}})],1),e._v(" "),a("div",{staticClass:"content-wapper"},[a("v-logscontent2",{ref:"logContent",attrs:{searchConditions:e.searchConditions,tableHead:e.tableHead,searchUrl:e.searchUrl,layerObj:e.layerObj,moreDeleteBtn:!0}})],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"top-title"},[this._v("数据库日志查询\n            "),t("div",{staticClass:"equipemnt-tools-btns"})])}]};var d=a("VU/8")(n,r,!1,function(e){a("ZpgR")},"data-v-45c3b3fc",null);t.default=d.exports},ZpgR:function(e,t){}});