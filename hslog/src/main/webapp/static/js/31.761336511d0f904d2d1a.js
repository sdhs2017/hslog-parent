webpackJsonp([31],{"VIa+":function(e,t){},x18F:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("mvHQ"),n=a.n(i),o=a("ID1p"),r=a("AIWI"),l=a("qTy0"),s=a("8+FI"),p={name:"equipmentLogs",data:function(){var e=this;return{layerObj:{detailData:{},layerState:!1},busName:"",equipmentId:"",equipmentName:"",equipmentData:[],searchConditions:{id:"",starttime:"",endtime:"",operation_level:""},searchUrl:"log/getLogListByEquipment.do",formConditionsArr:[],tableHead:[],equipmentHead:[{prop:"name",label:"资产名称",width:""},{prop:"hostName",label:"主机名",width:""},{prop:"type",label:"资产类型",width:"",formatData:function(t){var a="",i=t.substring(0,2);for(var n in e.typeArr){var o=e.typeArr[n];if(o.value==i){for(var r in a+=o.label+"-",o.children)if(o.children[r].value==t){a+=o.children[r].label;break}break}}return a}},{prop:"logType",label:"日志类型",width:""},{prop:"ip",label:"IP地址",width:"125"},{prop:"createTime",label:"进入时间",width:"",formatData:function(e){if(null!==e)return e.split(".")[0]}},{prop:"upDateTime",label:"更新时间",width:"",formatData:function(e){if(null!==e)return e.split(".")[0]}},{prop:"endTime",label:"截止时间",width:"",formatData:function(e){if(null!==e)return e.split(".")[0]}},{prop:"startUp",label:"是否启用",width:"",formatData:function(e){return"1"==e?"是":"否"}}],typeArr:[],firstSearch:!0,logConfig:{},logType:"",logLevel:[],levelVal:""}},created:function(){this.getEquipmentType(),this.formConditionsArr=[{label:"事件范围",type:"datetimerange",itemType:"",paramName:"time",model:{model:[]},val:""},{label:"日志级别",paramName:"operation_level",type:"select",itemType:"multiple",model:{model:this.levelVal},options:this.logLevel}]},methods:{getEquipmentData:function(){var e=this;this.$nextTick(function(){e.$axios.post(e.$baseUrl+"/equipment/selectEquipment.do",e.$qs.stringify({id:e.equipmentId})).then(function(t){e.equipmentData=t.data,e.logType=e.equipmentData[0].logType}).catch(function(e){})})},getEquipmentType:function(){var e=this;this.$nextTick(function(){e.$axios.get("static/filejson/equiptype.json",{}).then(function(t){e.typeArr=t.data}).catch(function(e){console.log(e)})})},setLogConfig:function(e){var t=this,a=JSON.parse(sessionStorage.getItem("logConfig")),i=a[e].level;for(var n in i){var o={value:i[n],label:i[n]};this.logLevel.push(o)}var r=a[e].tableHead;r.push({prop:"tools",label:"操作",width:"60",btns:[{icon:"el-icon-tickets",text:"查看详情",btnType:"readDetails",clickFun:function(e,a){t.layerObj.layerState=!0,t.layerObj.detailData=e}},{icon:"el-icon-circle-close",text:"删除",btnType:"removeItem",clickFun:function(e,a){t.$refs.logContent.removeParams([e])}}]}),this.tableHead=r}},watch:{equipmentId:function(){var e=this;s.default.$on(this.busName,function(t){e.searchConditions={starttime:t.starttime,endtime:t.endtime,operation_level:t.operation_level,id:e.equipmentId}})},logType:function(e,t){this.setLogConfig(e)}},beforeRouteEnter:function(e,t,a){a(function(t){t.$options.name="equipmentLogs"+e.query.id,t.equipmentName=e.query.name,t.busName="equipmentLogs"+e.query.id;var a={path:"equipmentLogs"+e.query.id,component:"logsManage/equipmentLogs.vue",title:"日志"};sessionStorage.setItem("/equipmentLogs"+e.query.id,n()(a)),""!==t.equipmentId&&t.equipmentId===e.query.id||(t.equipmentId=e.query.id,t.searchConditions.id=t.equipmentId,t.getEquipmentData())})},components:{vSearchForm:o.default,vLogscontent:r.default,vBasetable:l.default}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-bg"},[a("div",{staticClass:"top-title"},[e._v("'"+e._s(e.equipmentName)+"' 日志")]),e._v(" "),a("div",{staticClass:"search-wapper"},[a("v-search-form",{attrs:{formItem:e.formConditionsArr,busName:e.busName}})],1),e._v(" "),a("div",{staticClass:"equipment-table"},[a("v-basetable",{attrs:{tableHead:e.equipmentHead,tableData:e.equipmentData}})],1),e._v(" "),a("div",{staticClass:"content-wapper"},[a("v-logscontent",{ref:"logContent",attrs:{searchConditions:e.searchConditions,tableHead:e.tableHead,searchUrl:e.searchUrl,layerObj:e.layerObj,moreDeleteBtn:!0}})],1)])},staticRenderFns:[]};var m=a("VU/8")(p,u,!1,function(e){a("VIa+")},"data-v-326eed07",null);t.default=m.exports}});