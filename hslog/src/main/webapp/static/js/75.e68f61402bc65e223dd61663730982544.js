webpackJsonp([75],{"3vAp":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("58QH"),o=i("8+FI"),n=i("XLwt"),r={name:"graph",data:function(){return{ip:"",type:"",count:"",loading:!1,busName:"",timepicker:[]}},created:function(){this.timepicker=[this.$route.query.starttime,this.$route.query.endtime],this.ip=this.$route.query.iporport,this.type=this.$route.query.type,this.count=this.$route.query.count,this.busName="graph"+this.$route.query.val},mounted:function(){var t=this;o.default.$on(this.busName,function(e){t.timepicker=e,t.getTopologicalData(t.timepicker)})},beforeDestroy:function(){o.default.$off(this.busName)},methods:{getTopologicalData:function(t){var e=this;this.loading=!0;var i=n.init(document.getElementById("graph-content")),a={backgroundColor:"#3A4D5F",title:{text:"网络关系图",x:"center",textStyle:{color:""}},tooltip:{formatter:function(t){return"edge"===t.dataType?t.data.count:t.data.name+"<br/> 次数："+t.data.count}},series:[{type:"graph",top:"10%",roam:!0,focusNodeAdjacency:!0,force:{repulsion:500,edgeLength:[100,100]},layout:"force",symbol:"circle",edgeSymbol:["circle","arrow"],lineStyle:{normal:{opacity:.7}},label:{normal:{show:!0,position:"inside",textStyle:{fontSize:12}}},data:[],links:[{}],animationEasingUpdate:"quinticInOut",animationDurationUpdate:100}]};i.setOption(a);this.$nextTick(function(){e.$axios.post(e.$baseUrl+"/flow/getTopologicalData.do",e.$qs.stringify({groupfiled:e.type,iporport:e.ip,count:e.count,starttime:t[0],endtime:t[1]})).then(function(t){e.loading=!1;var o=t.data,n=o[0].data,r=n[0].count;for(var s in n)n[s].itemStyle={},n[s].draggable=!0,n[s].symbolSize=100*Math.pow(n[s].count/r,1/3),1===n[s].node?n[s].itemStyle.color="#de9325":2===n[s].node?n[s].itemStyle.color="#5f9da5":3===n[s].node&&(n[s].itemStyle.color="#bda29a");var l=o[0].links,c=[];for(var s in l)1===l[s].node&&c.push(l[s].count);var u=Math.max.apply(null,c);for(var s in l){l[s].lineStyle={};var d=10*Math.pow(l[s].count/u,1/3);l[s].symbolSize=[d,2*d],l[s].lineStyle.width=d,1===l[s].node?l[s].lineStyle.color="#EBC38C":2===l[s].node&&(l[s].lineStyle.color="#aed1d5")}a.series[0].data=n,a.series[0].links=l,i.setOption(a),window.addEventListener("resize",function(){i.resize()})}).catch(function(t){e.loading=!1,layer.msg("获取信息失败",{icon:5})})})}},beforeRouteEnter:function(t,e,i){i(function(e){e.$options.name="graph"+t.query.iporport,""===e.ip||(e.ip,t.query.iporport)})},components:{baseDate:a.default}},s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content-bg"},[e("div",{staticClass:"top-title"},[this._v(this._s(this.ip)+" 关系图\n        "),e("div",{staticClass:"datepicker-wapper",staticStyle:{"padding-left":"20px",float:"right","margin-right":"10px"}},[e("baseDate",{attrs:{type:"datetimerange",busName:this.busName,defaultVal:this.timepicker}})],1)]),this._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:this.loading,expression:"loading"}],staticClass:"graph-wapper",attrs:{"element-loading-background":"rgba(48, 62, 78, 0.5)"}},[e("div",{attrs:{id:"graph-content"}})])])},staticRenderFns:[]};var l=i("VU/8")(r,s,!1,function(t){i("whK5")},"data-v-4a504c7a",null);e.default=l.exports},whK5:function(t,e){}});