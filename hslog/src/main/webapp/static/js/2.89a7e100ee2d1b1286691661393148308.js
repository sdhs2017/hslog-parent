webpackJsonp([2],{"2Tct":function(t,e){},"5Xoe":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("8+FI"),i={data:function(){return{tagsList:[],ulLeft:0,homePage:localStorage.getItem("homePage")}},methods:{isActive:function(t){return t===this.$route.fullPath},closeTags:function(t){var e=this.tagsList.splice(t,1)[0],s=this.tagsList[t]?this.tagsList[t]:this.tagsList[t-1];this.$store.commit("deleteRoute",t),s?e.path===this.$route.fullPath?this.$router.push(s.path):this.setTags(this.$route):this.$router.push(this.homePage)},closeAll:function(){this.tagsList=[],this.$router.push(this.homePage)},closeOther:function(){var t=this,e=this.tagsList.filter(function(e){return e.path===t.$route.fullPath});this.tagsList=e},setTags:function(t){if(!this.tagsList.some(function(e){return e.path===t.fullPath})){var e="";-1!==t.fullPath.indexOf("=")&&(e=""===t.fullPath.split("=")[1].split("&")[0]?decodeURIComponent(t.fullPath.split("=")[1]):decodeURIComponent(t.fullPath.split("=")[1].split("&")[0]));var s={title:t.meta.title,path:t.fullPath,name:t.matched[1].components.default.name,other:e};this.tagsList.push(s),this.$store.commit("pushRoute",s),this.computedLeft()}a.default.$emit("tags",this.tagsList)},handleTags:function(t){"other"===t?this.closeOther():this.closeAll()},computedLeft:function(){var t=$(".ul-wapper").width()-($(".ul-wapper ul").width()+139);this.ulLeft=t>=0?0:t},goLeft:function(){if(0!==this.ulLeft){var t=$(".ul-wapper").width();this.ulLeft+=t,this.ulLeft>0&&(this.ulLeft=0)}},goRight:function(){var t=$(".ul-wapper").width(),e=$(".ul-wapper ul").width();Math.abs(this.ulLeft-t)<e&&(this.ulLeft-=t)},move:function(t){}},computed:{showTags:function(){return this.tagsList.length>0},tagLeft:function(){return $(".ul-wapper").width()-$("ul").width()}},watch:{$route:function(t,e){this.setTags(t)}},created:function(){var t=this;this.setTags(this.$route),a.default.$on("router",function(e){t.tagsList.push(e),console.log("c")})}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.showTags?s("div",{staticClass:"tags"},[s("span",{staticClass:"go-left",on:{click:t.goLeft}},[s("i",{staticClass:"el-icon-d-arrow-left"})]),t._v(" "),s("div",{staticClass:"ul-wapper"},[s("ul",{style:{left:t.ulLeft+"px"},on:{mousedown:t.move}},t._l(t.tagsList,function(e,a){return s("li",{key:a,staticClass:"tags-li",class:{active:t.isActive(e.path)}},[e.other?s("router-link",{staticClass:"tags-li-title",attrs:{to:e.path,title:e.other+e.title,"data-ss":"eee"}},[s("span",{staticClass:"tag-item-wapper"},[s("span",{staticClass:"tag-span"},[t._v(t._s(e.other))]),t._v(t._s(e.title))])]):s("router-link",{staticClass:"tags-li-title",attrs:{to:e.path}},[t._v("\n                        "+t._s(e.title)+"\n                    ")]),t._v(" "),1!==t.tagsList.length?s("span",{staticClass:"tags-li-icon",on:{click:function(e){return t.closeTags(a)}}},[s("i",{staticClass:"el-icon-close"})]):t._e()],1)}),0)]),t._v(" "),s("span",{staticClass:"go-right",on:{click:t.goRight}},[s("i",{staticClass:"el-icon-d-arrow-right"})]),t._v(" "),s("div",{staticClass:"tags-close-box"},[s("el-dropdown",{on:{command:t.handleTags}},[s("el-button",{attrs:{size:"mini",type:"primary"}},[t._v("\n                    标签选项"),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown",size:"small"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"other"}},[t._v("关闭其他")])],1)],1)],1)]):t._e()},staticRenderFns:[]};var o=s("VU/8")(i,l,!1,function(t){s("U08i")},null,null);e.default=o.exports},"9bBU":function(t,e,s){s("mClu");var a=s("FeBl").Object;t.exports=function(t,e,s){return a.defineProperty(t,e,s)}},C4MV:function(t,e,s){t.exports={default:s("9bBU"),__esModule:!0}},EfUc:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("8+FI"),i=s("/sA3"),l={data:function(){return{collapse:!1,items:[],systemId:1,currentUrl:""}},computed:{onRoutes:function(){return this.$route.path.replace("/","")}},created:function(){var t=this;a.default.$on("collapse",function(e){t.collapse=e}),a.default.$on("systemId",function(e){t.systemId=e}),this.getMenuData(this.systemId)},watch:{systemId:function(t){this.getMenuData(t)}},methods:{goToHtml:function(t){if(this.currentUrl=t.url,t.url.split("path=").length>1){var e=JSON.parse(JSON.parse(t.url.split("path=")[1])),s={};for(var a in s.name=t.menuName,e.query)s[a]=e.query[a];Object(i.l)(e.routeName+e.query.id,e.vuePath,s,"")}else{if(-1!==t.url.indexOf("/")){t.url=t.url.split("/")[1].split(".")[0],"logIndex"===t.url&&(t.url="index"),"searchLogs2"===t.url&&(t.url="accurateSearch"),"serviceManage"===t.url&&(t.url="controlCenter");var l=t.url.replace("device","equipment");t.url=l;var o=t.url.replace("Device","Equipment");t.url=o}this.$router.push(t.url)}},getMenuData:function(t){var e=this;this.$nextTick(function(){e.$axios.post(e.$baseUrl+"/menu/selectMenu.do",e.$qs.stringify({systemID:t})).then(function(t){e.items=t.data}).catch(function(t){console.log(t)})})}}},o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sidebar"},[s("el-menu",{staticClass:"sidebar-el-menu",attrs:{"default-active":t.onRoutes,collapse:t.collapse,"background-color":"#1A242F","text-color":"#bfcbd9","active-text-color":"#20a0ff"}},[t._l(t.items,function(e){return[e.menus?[s("el-submenu",{key:e.id,attrs:{index:e.id}},[s("template",{slot:"title"},[s("i",{class:e.icon}),s("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.menuName))])]),t._v(" "),t._l(e.menus,function(e){return[e.menus?s("el-submenu",{key:e.url,attrs:{index:e.url}},[s("template",{slot:"title"},[t._v(t._s(e.menuName))]),t._v(" "),t._l(e.menus,function(e,a){return s("el-menu-item",{key:a,attrs:{index:e.url}},[t._v("\n                                "+t._s(e.menuName)+"\n                            ")])})],2):s("el-menu-item",{key:e.url,class:e.url===t.currentUrl?"currentClass":"",attrs:{index:e.url},nativeOn:{click:function(s){return t.goToHtml(e)}}},[t._v("\n                            "+t._s(e.menuName)+"\n                        ")])]})],2)]:t._e()]})],2)],1)},staticRenderFns:[]};var n=s("VU/8")(l,o,!1,function(t){s("2Tct")},"data-v-6fc33cdc",null);e.default=n.exports},GgDs:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,i=s("bOdI"),l=s.n(i),o=s("mvHQ"),n=s.n(o),r=s("8+FI"),c=s("/sA3"),u=l()({data:function(){return{lockLoading:!1,alertCount:0,alertParam:{starttime:"",endtime:""},bellArr:[],loading:!1,collapse:!1,fullscreen:!1,passWordForm:!1,message:2,phone:"",roleName:"",passwordObj:{oldPassword:"",password:""},password2:"",mode:0,systemMenu:[],current:0,blockDialog:!1,userpaw:"",paw_placeholder:""}},watch:{"passwordObj.password":function(t){this.mode=Object(c.d)(t)}},computed:{username:function(){var t=localStorage.getItem("ms_username");return t||this.name}},created:function(){var t=this,e=new Date,s=new Date;s.setTime(s.getTime()-864e5*this.$store.state.beforeDay),this.alertParam.endtime=Object(c.e)("yyyy-mm-dd HH:MM:SS",e),this.alertParam.starttime=Object(c.e)("yyyy-mm-dd HH:MM:SS",s),this.getAlertData(),this.getSystem(),this.getUserImformation(),this.getBellData(),setInterval(function(){t.getBellData()},3e5);var a=JSON.parse(localStorage.getItem("LoginUser"));this.phone=a.phone,this.getLockState()},mounted:function(){window.onresize=function(){console.log(document.body.clientWidth)}},methods:(a={getUserImformation:function(){var t=this;this.$nextTick(function(){t.$axios.get(t.$baseUrl+"/user/selectUserRole.do","").then(function(e){var s=e.data;s.success,t.roleName=s.message}).catch(function(t){})})},getKey:function(){var t=this;this.$nextTick(function(){t.loading=!0,t.$axios.post(t.$baseUrl+"/rsa/getRSAPublicKey.do",t.$qs.stringify()).then(function(e){t.loading=!1;var s=e.data;if("true"==s.success){var a=s.message,i=new JSEncrypt;i.setPublicKey("-----BEGIN PUBLIC KEY-----"+a+"-----END PUBLIC KEY-----");var l=i.encrypt(t.ruleForm.phone),o=i.encrypt(t.ruleForm.password);t.login(l,o,index1)}else layer.msg(s.message,{icon:5})}).catch(function(e){t.loading=!1})})},changePassWord:function(){var t=this;""===this.passwordObj.oldPassword?layer.msg("请填写原来密码",{icon:5}):""===this.passwordObj.password?layer.msg("未填写新的密码",{icon:5}):this.passwordObj.password!==this.password2?layer.msg("两次密码输入不一致",{icon:5}):(layer.load(1),this.$nextTick(function(){t.$axios.post(t.$baseUrl+"/rsa/getRSAPublicKey.do",t.$qs.stringify()).then(function(e){var s=e.data;if("true"==s.success){var a=s.message,i=new JSEncrypt;i.setPublicKey("-----BEGIN PUBLIC KEY-----"+a+"-----END PUBLIC KEY-----");var l=JSON.parse(n()(t.passwordObj)),o=JSON.parse(localStorage.getItem("LoginUser"));l.id=o.id,l.oldPassword=i.encrypt(l.oldPassword),l.password=i.encrypt(l.password),t.$nextTick(function(){t.$axios.post(t.$baseUrl+"/user/updatePasswordById.do",t.$qs.stringify(l)).then(function(e){layer.closeAll(),"true"===e.data.success?(layer.msg(e.data.message,{icon:1}),t.passWordForm=!1):"false"===e.data.success&&layer.msg(e.data.message,{icon:5})}).catch(function(t){})})}else layer.msg(s.message,{icon:5})}).catch(function(e){t.loading=!1})}))},handleCommand:function(t){var e=this;"loginout"===t?(layer.load(1),this.$nextTick(function(){e.$axios.get(e.$baseUrl+"/user/logout.do","").then(function(t){layer.closeAll("loading"),"true"===t.data.success&&(localStorage.removeItem("ms_username"),e.$router.push("/login"))}).catch(function(t){layer.closeAll("loading")})})):"showPasswordForm"===t&&(this.paw_placeholder=sessionStorage.getItem("pawComplex"),this.passwordObj={oldPassword:"",password:""},this.password2="",this.passWordForm=!0)},collapseChage:function(){this.collapse=!this.collapse,r.default.$emit("collapse",this.collapse)},handleFullScreen:function(){var t=document.documentElement;this.fullscreen?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen():t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen(),this.fullscreen=!this.fullscreen},getSystem:function(){var t=this;this.$nextTick(function(){t.loading=!0,t.$axios.post(t.$baseUrl+"/menu/selectSystem.do","").then(function(e){t.loading=!1,t.systemMenu=e.data,r.default.$emit("systemId",e.data[0].id)}).catch(function(e){t.loading=!1})})},changeSystem:function(t,e){var s=this;this.current=e,r.default.$emit("systemId",t),this.collapse?(this.collapse=!1,r.default.$emit("collapse",this.collapse)):(this.collapseChage(),setTimeout(function(){s.collapseChage()},700))},getBellData:function(){var t=this;this.$nextTick(function(){t.$axios.post(t.$baseUrl+"/equipment/selectRisk.do","").then(function(e){t.bellArr=e.data}).catch(function(t){})})},getAlertData:function(){var t=this;this.$nextTick(function(){t.$axios.post(t.$baseUrl+"/alert/getAlertFireCount.do",t.$qs.stringify(t.alertParam)).then(function(e){t.alertCount=Number(e.data.message)}).catch(function(t){})})},goToThreat:function(t){Object(c.l)("equipmentThreat"+t.id,"equipment/equipmentThreat.vue",{name:t.name,id:t.id,logType:t.logType},"威胁分析")},goToAlert:function(){this.$router.push("/alert")}},l()(a,"getKey",function(){var t=this;this.$nextTick(function(){t.lockLoading=!0,t.$axios.post(t.$baseUrl+"/rsa/getRSAPublicKey.do",t.$qs.stringify()).then(function(e){t.lockLoading=!1;var s=e.data;if("true"==s.success){var a=s.message,i=new JSEncrypt;i.setPublicKey("-----BEGIN PUBLIC KEY-----"+a+"-----END PUBLIC KEY-----");var l=i.encrypt(t.userpaw);t.removeBlock(l)}else layer.msg(s.message,{icon:5})}).catch(function(e){t.loading=!1})})}),l()(a,"getLockState",function(){var t=this;this.$nextTick(function(){t.$axios.post(t.$baseUrl+"/user/getUserLockState.do",t.$qs.stringify()).then(function(e){"true"==e.data.success&&(t.blockDialog=!0)}).catch(function(e){t.loading=!1})})}),l()(a,"blockUser",function(){var t=this;this.$nextTick(function(){t.$axios.post(t.$baseUrl+"/user/userLocked.do",t.$qs.stringify()).then(function(e){t.loading=!1;var s=e.data;"true"==s.success?t.blockDialog=!0:layer.msg(s.message,{icon:5})}).catch(function(e){t.loading=!1})})}),l()(a,"removeBlock",function(t){var e=this;this.lockLoading=!0,this.$nextTick(function(){e.$axios.post(e.$baseUrl+"/user/userUnlock.do",e.$qs.stringify({password:t})).then(function(t){e.lockLoading=!1;var s=t.data;"true"==s.success?e.blockDialog=!1:layer.msg(s.message,{icon:5})}).catch(function(t){e.lockLoading=!1})})}),a)},"mounted",function(){document.body.clientWidth<1500&&this.collapseChage()}),d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"header",attrs:{"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(48, 62, 78, 0.2)"}},[s("div",{staticClass:"collapse-btn",on:{click:t.collapseChage}},[s("i",{staticClass:"el-icon-menu"})]),t._v(" "),s("div",{staticClass:"logo"},[s("img",{attrs:{src:t.$store.state.systemObj.logo,alt:""}}),t._v(" "),s("span",{staticStyle:{position:"absolute",top:"-7px",left:"320px","font-size":"10px"}},[t._v(t._s(t.$store.state.systemObj.version))])]),t._v(" "),s("ul",{staticClass:"header-ul"},t._l(this.systemMenu,function(e,a){return s("li",{key:a,class:{active:a===t.current},on:{click:function(s){return t.changeSystem(e.id,a)}}},[s("i",{class:e.icon}),t._v(t._s(e.systemName))])}),0),t._v(" "),s("div",{staticClass:"header-right"},[s("div",{staticClass:"header-user-con"},[s("div",{staticClass:"btn-bell"},[s("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"click"}},[0!==t.alertCount?s("ul",{staticClass:"bell-ul"},[s("li",{staticClass:"bell-li",attrs:{title:"点击查看具体告警信息"},on:{click:function(e){return t.goToAlert()}}},[s("p",{staticClass:"top-p"},[s("b",{staticClass:"name-b"},[t._v("最近"+t._s(this.$store.state.beforeDay)+"天")])]),t._v(" "),s("p",{staticClass:"bottom-p"},[t._v("发生告警次数为 "),s("b",{staticClass:"high-b"},[t._v(" "+t._s(t.alertCount))])])])]):t._e(),t._v(" "),t.bellArr.length?s("ul",{staticClass:"bell-ul"},t._l(t.bellArr,function(e,a){return s("li",{key:a,staticClass:"bell-li",attrs:{title:"点击查看具体信息"},on:{click:function(s){return t.goToThreat(e)}}},[s("p",{staticClass:"top-p"},[s("b",{staticClass:"name-b"},[t._v(t._s(e.name)+"(资产) : ")])]),t._v(" "),s("p",{staticClass:"bottom-p"},[0!==e.high_risk?s("span",[t._v("高危事件数 "),s("b",{staticClass:"high-b"},[t._v(t._s(e.high_risk))])]):t._e(),t._v(" "),0!==e.moderate_risk?s("span",[t._v("    中危事件数 "),s("b",{staticClass:"center-b"},[t._v(t._s(e.moderate_risk))])]):t._e()])])}),0):t._e(),t._v(" "),0==t.alertCount&&0===t.bellArr.length?s("ul",{staticClass:"bell-ul"},[s("li",{staticStyle:{"text-align":"center"}},[t._v("暂无告警事件")])]):t._e(),t._v(" "),s("el-button",{staticClass:"bell-wapper",attrs:{slot:"reference"},slot:"reference"},[s("el-badge",{staticClass:"item",attrs:{value:t.bellArr.length+t.alertCount,hidden:0===t.bellArr.length&&0===t.alertCount,max:99}},[s("i",{staticClass:"el-icon-message-solid"})])],1)],1)],1),t._v(" "),s("el-dropdown",{staticClass:"user-name",attrs:{trigger:"click"},on:{command:t.handleCommand}},[s("span",{staticClass:"el-dropdown-link"},[t._v("\n                        "+t._s(t.roleName)+" - "+t._s(t.phone)+" "),s("i",{staticClass:"el-icon-caret-bottom"})]),t._v(" "),s("el-dropdown-menu",{staticClass:"drop-menu",attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"showPasswordForm"}},[t._v("修改密码")]),t._v(" "),s("el-dropdown-item",{attrs:{command:"loginout"}},[t._v("退出登录")])],1)],1),t._v(" "),s("div",{staticClass:"btn-fullscreen",on:{click:t.handleFullScreen}},[s("el-tooltip",{attrs:{effect:"dark",content:t.fullscreen?"取消全屏":"全屏",placement:"bottom"}},[s("i",{staticClass:"el-icon-rank"})])],1),t._v(" "),s("div",{staticClass:"btn-block",on:{click:t.blockUser}},[s("el-tooltip",{attrs:{effect:"dark",content:"锁定",placement:"bottom"}},[s("i",{staticClass:"el-icon-lock"})])],1)],1)]),t._v(" "),s("el-dialog",{attrs:{title:"修改密码",visible:t.passWordForm,width:"400px"},on:{"update:visible":function(e){t.passWordForm=e}}},[s("el-form",{attrs:{"label-width":"100px"}},[s("el-form-item",{attrs:{label:"旧的密码:"}},[s("el-input",{staticClass:"item",attrs:{type:"password",placeholder:"旧的密码",maxlength:"18"},model:{value:t.passwordObj.oldPassword,callback:function(e){t.$set(t.passwordObj,"oldPassword",e)},expression:"passwordObj.oldPassword"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"新的密码:"}},[s("el-input",{staticClass:"item",attrs:{type:"password",placeholder:t.paw_placeholder,maxlength:"18"},model:{value:t.passwordObj.password,callback:function(e){t.$set(t.passwordObj,"password",e)},expression:"passwordObj.password"}})],1),t._v(" "),t.passwordObj.password.length>0?s("ul",{staticClass:"pass_set"},[s("li",{staticStyle:{"background-color":"rgb(237, 62, 13)"},attrs:{id:"strength_L"}},[t._v("弱")]),t._v(" "),s("li",{style:t.mode>=2?{background:"#ffaf56"}:{},attrs:{id:"strength_M"}},[t._v("中")]),t._v(" "),s("li",{style:t.mode>2?{background:"#6ba001"}:{},attrs:{id:"strength_H"}},[t._v("强")])]):t._e(),t._v(" "),s("el-form-item",{attrs:{label:"确认密码:"}},[s("el-input",{staticClass:"item",attrs:{type:"password",placeholder:t.paw_placeholder,maxlength:"18"},model:{value:t.password2,callback:function(e){t.password2=e},expression:"password2"}})],1)],1),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:t.changePassWord}},[t._v("确 定")]),t._v(" "),s("el-button",{on:{click:function(e){t.passWordForm=!1}}},[t._v("取 消")])],1)],1),t._v(" "),t.blockDialog?s("div",{staticClass:"block-wapper"},[s("div",{staticClass:"con-wapper"},[t._m(0),t._v(" "),s("div",{staticStyle:{display:"flex"}},[s("el-input",{staticClass:"item",attrs:{type:"password",placeholder:"",maxlength:"18"},model:{value:t.userpaw,callback:function(e){t.userpaw=e},expression:"userpaw"}}),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.getKey}},[t._v("解锁")]),t._v(" "),s("div",{staticStyle:{width:"30px"}},[t.lockLoading?s("i",{staticClass:"el-icon-loading"}):t._e()])],1)])]):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{"font-size":"260px"}},[e("i",{staticClass:"el-icon-lock"})])}]};var p=s("VU/8")(u,d,!1,function(t){s("TY22")},"data-v-5fb56ef7",null);e.default=p.exports},MpTN:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("GgDs"),i=s("EfUc"),l=s("zJHf"),o=s("5Xoe"),n=s("8+FI"),r={data:function(){return{tagsList:[],collapse:!1}},components:{vHead:a.default,vSidebar:i.default,vTags:o.default,vBottom:l.default},created:function(){var t=this;n.default.$on("collapse",function(e){t.collapse=e}),n.default.$on("tags",function(e){for(var s=[],a=0,i=e.length;a<i;a++)e[a].name&&s.push(e[a].name);t.tagsList=s}),this.$nextTick(function(){t.$axios.get("static/filejson/logconfig.json",{}).then(function(e){t.$store.commit("updateLogShowColumn",e.data)}).catch(function(t){})})},computed:{key:function(){return void 0!==this.$route.name?this.$route.name:this.$route}},beforeRouteEnter:function(t,e,s){s(function(t){})}},c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"wrapper"},[e("v-head"),this._v(" "),e("v-sidebar"),this._v(" "),e("div",{staticClass:"content-box",class:{"content-collapse":this.collapse}},[e("v-tags"),this._v(" "),e("div",{staticClass:"content"},[e("transition",{attrs:{name:"move",mode:"out-in"}},[e("keep-alive",{attrs:{include:this.tagsList}},[e("router-view",{key:this.key})],1)],1)],1)],1),this._v(" "),e("v-bottom")],1)},staticRenderFns:[]},u=s("VU/8")(r,c,!1,null,null,null);e.default=u.exports},TY22:function(t,e){},U08i:function(t,e){},VgNJ:function(t,e){},bOdI:function(t,e,s){"use strict";e.__esModule=!0;var a,i=s("C4MV"),l=(a=i)&&a.__esModule?a:{default:a};e.default=function(t,e,s){return e in t?(0,l.default)(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}},mClu:function(t,e,s){var a=s("kM2E");a(a.S+a.F*!s("+E39"),"Object",{defineProperty:s("evD5").f})},zJHf:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("mvHQ"),i=s.n(a),l=s("/sA3"),o={data:function(){return{loading:!1,es_bulk:1,concurrent_requests:"",thresholdText:"状态获取中",editIpWapper:!1,changeIpObj:{ip:"",Netmask:"",gateway:""},diskUsedState:!1,systemIp:"获取中",systemIpChangeState:!1,sysThresholdValue:90,dataThresholdValue:80,diskObj:{sizeNum:"",usedNum:"",sysAllDisk:"",sysUsedDisk:"",dataAllDisk:"",dataUsedDisk:""},backupWapper:!1,backupObj:{backupState:!1,backupDate:""},backupObj2:{backupState:!1,backupDate:""},licenseDueTime:"",customName:""}},created:function(){this.getEsBulk(),setInterval(this.getDiskUsed,6e6),this.getIp();var t=localStorage.getItem("backupDate");t&&(this.backupObj=JSON.parse(t),this.backupObj2=JSON.parse(t)),this.licenseDueTime=localStorage.getItem("licenseDueTime"),this.customName=localStorage.getItem("customName")},watch:{editIpWapper:function(){this.editIpWapper||(this.changeIpObj={ip:"",Netmask:"",gateway:""})}},methods:{getDiskUsed:function(){var t=this;this.$axios.get(this.$baseUrl+"/manage/getDiskUsage.do",{}).then(function(e){if(void 0!==e.data.error)t.thresholdText=e.data.error;else{var s=Number(e.data.size),a=Number(e.data.used);t.diskObj={sizeNum:s,usedNum:a,sysAllDisk:e.data.sys_size,sysUsedDisk:e.data.sys_used,dataAllDisk:e.data.data_size,dataUsedDisk:e.data.data_used},t.thresholdText="";var i=JSON.parse(sessionStorage.getItem("diskUsedSetting")),l=Number(e.data.data_per.split("%")[0]);t.sysThresholdValue<=Number(e.data.sys_per.split("%")[0])&&(t.thresholdText+="系统盘空间不足,剩余 "+e.data.sys_avail,$(".threshold").css("color","#d9534f")),t.dataThresholdValue<=Number(e.data.data_per.split("%")[0])&&(t.thresholdText+=" 数据盘空间不足,剩余 "+e.data.data_avail,$(".threshold").css("color","#d9534f")),""===t.thresholdText&&(t.thresholdText="磁盘空间充足",$(".threshold").css("color","#1ab394")),Number(i.disk_data_watermark_high)<=l?layer.open({content:"数据盘到达设置的阈值（已满），会对历史数据进行覆盖",closeBtn:0,yes:function(t,e){layer.close(t)}}):Number(i.disk_data_watermark)<=l&&layer.open({content:"数据盘到达设置的阈值（将满）",closeBtn:0,yes:function(t,e){layer.close(t)}})}}).catch(function(t){console.log(t)})},setRang:function(){this.diskUsedState=!0,this.getEsBulk()},getEsBulk:function(){var t=this;this.loading=!0,this.$nextTick(function(){t.$axios.post(t.$baseUrl+"/configuration/selectAll.do","").then(function(e){if(t.loading=!1,"true"===e.data.success){var s=e.data.data;for(var a in s)"disk_data_watermark"===s[a].configuration_key?t.dataThresholdValue=s[a].configuration_value:"disk_system_watermark"===s[a].configuration_key&&(t.sysThresholdValue=s[a].configuration_value);t.getDiskUsed()}else layer.msg(e.data.message,{icon:5})}).catch(function(e){t.loading=!1})})},okBtn:function(){var t=this;this.$nextTick(function(){layer.load(1),t.$axios.post(t.$baseUrl+"/configuration/update.do",t.$qs.stringify({es_bulk:t.es_bulk,concurrent_requests:t.concurrent_requests,disk_system_watermark:t.sysThresholdValue,disk_data_watermark:t.dataThresholdValue})).then(function(e){layer.closeAll("loading"),"true"==e.data.success?(layer.msg(e.data.message,{icon:1}),t.thresholdText="状态获取中",t.getDiskUsed(),t.diskUsedState=!1):layer.msg(e.data.message,{icon:5})}).catch(function(t){layer.closeAll("loading")})})},getIp:function(){var t=this;this.$axios.post(this.$baseUrl+"/ip/getIp.do",this.$qs.stringify({})).then(function(e){"true"==e.data[0].success?t.systemIp=e.data[0].message:"false"==e.data[0].success&&(t.systemIp=e.data[0].message)}).catch(function(e){t.systemIp="获取失败"})},saveIp:function(){var t=this;this.$nextTick(function(){layer.load(1),t.$axios.post(t.$baseUrl+"/manage/modifyServerIP.do",t.$qs.stringify({ipaddr:t.changeIpObj.ip,gateway:t.changeIpObj.gateway,netmask:t.changeIpObj.Netmask})).then(function(e){layer.closeAll("loading"),"success"===e.data.state?(layer.msg(e.data.message),t.editIpWapper=!1):layer.msg(e.data.message)}).catch(function(t){layer.closeAll("loading")})})},saveBackup:function(){this.backupObj.backupDate.length||(this.backupObj.backupDate=Object(l.e)("yyyy-mm-dd HH:MM:SS",this.backupObj.backupDate)),this.backupWapper=!1;var t=i()(this.backupObj);this.backupObj2=JSON.parse(t),localStorage.setItem("backupDate",t)},backup:function(){console.log("sss")},goToConfig:function(){this.diskUsedState=!1,this.$router.push("/systemConfig_SR")}}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bottom"},[s("div",{staticClass:"b-left"}),t._v(" "),s("div",{staticClass:"b-right"},[s("div",{staticClass:"threshold"},[t._v(t._s(t.thresholdText)+" "),s("span",{staticClass:"set-rang",on:{click:t.setRang}},[t._v("（详情）")])]),t._v(" "),s("div",{staticClass:"systemIp"},[t._v("系统IP："),s("span",{staticStyle:{color:"#e4956d"}},[t._v(t._s(t.systemIp))]),t._v(" "),s("span",{staticClass:"set-rang",on:{click:function(e){t.editIpWapper=!0}}},[t._v("（修改IP）")])]),t._v(" "),t.customName?s("div",{staticClass:"custonName"},[t._v("单位名称："),s("span",{staticStyle:{color:"#e4956d"}},[t._v(t._s(t.customName))])]):t._e(),t._v(" "),t.licenseDueTime?s("div",{staticClass:"licenseDueTime"},[t._v("证书到期时间："),s("span",{staticStyle:{color:"#e4956d"}},[t._v(t._s(t.licenseDueTime))])]):t._e(),t._v(" "),s("div",{staticClass:"company"},[t._v(" 版权所有  © 2021-2022  山东九州信泰信息科技股份有限公司  ")])]),t._v(" "),s("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{title:"阈值详情",visible:t.diskUsedState,width:"440px","element-loading-background":"rgba(48, 62, 78, 0.5)"},on:{"update:visible":function(e){t.diskUsedState=e}}},[s("p",{staticStyle:{color:"#fff"}},[t._v("系统盘阈值大小："),s("b",{staticStyle:{color:"#e4956d"}},[t._v(t._s(t.sysThresholdValue)+"%")])]),t._v(" "),s("p",{staticStyle:{color:"#fff"}},[t._v("数据盘阈值大小："),s("b",{staticStyle:{color:"#e4956d"}},[t._v(t._s(t.dataThresholdValue)+"%")])]),t._v(" "),s("p",{staticStyle:{color:"#fff",display:"flex","justify-content":"space-between"}},[s("span",[t._v("总空间 ："),s("b",{staticStyle:{color:"#1ab394"}},[t._v(t._s(t.diskObj.sizeNum)+"G")])]),t._v(" "),s("span",[t._v("已用空间 ： "),s("b",{staticStyle:{color:"#e4956d"}},[t._v(t._s(t.diskObj.usedNum)+"G")])])]),t._v(" "),s("div",{staticStyle:{color:"#fff",padding:"10px",background:"#485b71"}},[s("p",[t._v("系统盘 : "),s("span",{staticStyle:{color:"#1ab394"}},[t._v(t._s(t.diskObj.sysAllDisk))]),t._v("(总) "),s("span",{staticStyle:{color:"#e4956d","margin-left":"20px"}},[t._v(t._s(t.diskObj.sysUsedDisk))]),t._v("(已用)")]),t._v(" "),s("p",[t._v("数据盘 : "),s("span",{staticStyle:{color:"#1ab394"}},[t._v(t._s(t.diskObj.dataAllDisk))]),t._v("(总) "),s("span",{staticStyle:{color:"#e4956d","margin-left":"20px"}},[t._v(t._s(t.diskObj.dataUsedDisk))]),t._v("(已用)")])]),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.diskUsedState=!1}}},[t._v("取 消")])],1)]),t._v(" "),s("el-dialog",{attrs:{title:"备份设置",visible:t.backupWapper,width:"440px"},on:{"update:visible":function(e){t.backupWapper=e}}},[s("el-form",{attrs:{"label-width":"120px","label-position":"left"}},[s("el-form-item",{attrs:{label:"备份时间:"}},[s("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:t.backupObj.backupDate,callback:function(e){t.$set(t.backupObj,"backupDate",e)},expression:"backupObj.backupDate"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"备份状态:"}},[s("el-switch",{attrs:{"active-text":"开启","inactive-text":"关闭"},model:{value:t.backupObj.backupState,callback:function(e){t.$set(t.backupObj,"backupState",e)},expression:"backupObj.backupState"}})],1)],1),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.saveBackup()}}},[t._v("确 定")]),t._v(" "),s("el-button",{on:{click:function(e){t.backupWapper=!1}}},[t._v("取 消")])],1)],1),t._v(" "),s("el-dialog",{attrs:{title:"修改IP",visible:t.editIpWapper,width:"440px"},on:{"update:visible":function(e){t.editIpWapper=e}}},[s("el-form",{attrs:{"label-width":"120px","label-position":"left"}},[s("el-form-item",{attrs:{label:"修改后IP:"}},[s("el-input",{attrs:{size:"mini",min:"1"},model:{value:t.changeIpObj.ip,callback:function(e){t.$set(t.changeIpObj,"ip",e)},expression:"changeIpObj.ip"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"子网掩码:"}},[s("el-input",{attrs:{size:"mini",min:"1"},model:{value:t.changeIpObj.Netmask,callback:function(e){t.$set(t.changeIpObj,"Netmask",e)},expression:"changeIpObj.Netmask"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"网关:"}},[s("el-input",{attrs:{size:"mini",min:"1"},model:{value:t.changeIpObj.gateway,callback:function(e){t.$set(t.changeIpObj,"gateway",e)},expression:"changeIpObj.gateway"}})],1)],1),t._v(" "),s("p",{staticStyle:{color:"#e4956d"}},[t._v("注：修改IP成功后，会重启服务器，请谨慎使用。")]),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",disabled:!(""!==t.changeIpObj.ip&&""!==t.changeIpObj.Netmask&&""!==t.changeIpObj.gateway)},on:{click:function(e){return t.saveIp()}}},[t._v("确 定")]),t._v(" "),s("el-button",{on:{click:function(e){t.editIpWapper=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var r=s("VU/8")(o,n,!1,function(t){s("VgNJ")},"data-v-3d263c66",null);e.default=r.exports}});