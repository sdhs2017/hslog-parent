webpackJsonp([80],{Dq8W:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("ID1p"),a=i("8+FI"),n=i("/sA3"),o={name:"equipment_group",data:function(){return{btnArr:[],backState:!1,backStateObj:{text:"",state:"false"},importState:!1,loading:!1,checkList:[],zzIndex:-2,busName:"searchEquipment2",size:15,c_page:1,allCounts:0,searchConditions:{name:"",hostname:"",ip:"",logType:"",type:"",asset_group_id:""},logBaseJson:[],logType:[],typeArr:[],selectEquipmentId:"",equipmentList:[],formConditionsArr:[],groupOpt:[]}},created:function(){var t=this;this.getLogType(),this.getAssetGroup(),this.formConditionsArr=[{label:"资产名称",paramName:"name",model:{model:""},itemType:"",type:"input"},{label:"IP地址",paramName:"ip",itemType:"",model:{model:""},type:"input"},{label:"主机名",paramName:"hostName",model:{model:""},itemType:"",type:"input"},{label:"日志类型",paramName:"logType",type:"select",itemType:"",model:{model:""},options:this.logType},{label:"资产组",paramName:"asset_group_id",type:"select",itemType:"",model:{model:""},options:this.groupOpt},{label:"资产类型",paramName:"type",type:"cascader",itemType:"",model:{model:[]},options:[]}],a.default.$on(this.busName,function(e){t.searchConditions=e,t.getData(t.searchConditions,1),t.c_page=1})},beforeDestroy:function(){a.default.$off(this.busName)},mounted:function(){},methods:{getAssetGroup:function(){var t=this;this.$nextTick(function(){t.$axios.post(t.$baseUrl+"/assetGroup/getAssetGroupList.do",t.$qs.stringify()).then(function(e){var i=e.data;"true"===i.success?(t.groupOpt=i.data,t.formConditionsArr[t.formConditionsArr.length-2].options=t.groupOpt):layer.msg(i.message,{icon:5})}).catch(function(t){console.log(t)})})},getLogType:function(){var t=this;this.$nextTick(function(){t.$axios.get("static/filejson/logTypeLevel.json",{}).then(function(e){t.logBaseJson=e.data,t.logType.push({value:"",label:"全部"});for(var i=0;i<e.data.length;i++){var s={value:e.data[i].type,label:e.data[i].label};t.logType.push(s)}}).catch(function(t){console.log(t)})})},getEquipmentType:function(t){var e=this;this.$nextTick(function(){e.$axios.get("static/filejson/equiptype.json",{}).then(function(i){for(var s in e.typeArr=i.data,e.formConditionsArr[e.formConditionsArr.length-1].options=e.typeArr,t){var a="",n=t[s].type.substring(0,2);for(var o in e.typeArr){var l=e.typeArr[o];if(l.value==n){for(var c in a+=l.label+"-",l.children)if(l.children[c].value==t[s].type){a+=l.children[c].label,t[s].type=a;break}break}}}e.equipmentList=t}).catch(function(t){console.log(t)})})},refreshEq:function(){this.c_page=1,this.getData(this.searchConditions,1)},getData:function(t,e){var i=this;this.$nextTick(function(){i.selectEquipmentId="",i.loading=!0;var s=t;s.pageIndex=e,s.pageSize=i.size,i.$axios.post(i.$baseUrl+"/equipment/selectPage.do",i.$qs.stringify(s)).then(function(t){i.loading=!1;var e=t.data[0].equipment;i.allCounts=JSON.parse(t.data[0].count.count),i.saveCondition=i.searchConditions,i.getEquipmentType(e)}).catch(function(t){i.loading=!1,console.log(t)})})},selectEquipment:function(){var t=this;this.$nextTick(function(){t.loading=!0,t.$axios.post(t.$baseUrl+"/equipment/selectEquipmentByLog.do",t.$qs.stringify({id:t.selectEquipmentId})).then(function(e){if(t.loading=!1,"false"===e.data.success)layer.msg(e.data.message,{icon:5});else{var i=e.data.equipment;t.allCounts=i.length,t.getEquipmentType(i),t.$nextTick(function(){$(".tools-more").wheelmenu({trigger:"hover",animation:"fly",animationSpeed:"fast",angle:"all"})})}}).catch(function(e){t.loading=!1,console.log(e)})})},handleCurrentChange:function(t){this.getData(this.saveCondition,t)},goToAddEquipment:function(){this.$router.push({path:"addEquipmentWithGroup"})},goToAllEcharts:function(){this.$router.push({path:"allEcharts"})},importEquipment:function(){var t=this;layer.confirm("此功能适用于实施人员，请谨慎操作。",{btn:["确定导入","取消"]},function(e){layer.close(e),t.importState=!0},function(){layer.close()})},removeEquipment:function(){var t=this;0===this.checkList.length?layer.msg("未选中任何资产",{icon:5}):layer.confirm("您确定删除么？",{btn:["确定","取消"]},function(e){layer.close(e);var i="";for(var s in t.checkList)i+=t.checkList[s]+",";t.$nextTick(function(){t.$axios.post(t.$baseUrl+"/equipment/deleteWithAssetGroup.do",t.$qs.stringify({id:i})).then(function(e){"true"==e.data.success?(layer.msg("删除成功",{icon:1}),t.getData(t.searchConditions,1),t.c_page=1):layer.msg("删除失败",{icon:5})}).catch(function(t){layer.msg("删除失败",{icon:5})})})},function(){layer.close()})},reviseEquipment:function(t,e){Object(n.l)("reviseEquipmentWithGroup"+t.id,"equipment/reviseEquipmentWithGroup.vue",{name:t.name,id:t.id},"资产修改")},equipmentLogs:function(t,e){Object(n.l)("equipmentLogs2"+t.id,"logsManage/equipmentLogs2.vue",{name:t.name,id:t.id,logType:t.logType},"日志")},equipmentEcharts:function(t,e){var i=t.logType;"syslog"===i?Object(n.l)("syslogEquipmentEcharts"+t.id,"equipment/syslogEquipmentEcharts.vue",{name:t.name,id:t.id},"统计"):"winlog"===i||"winlogbeat"===i?Object(n.l)("winEquipmentEcharts"+t.id,"equipment/winEquipmentEcharts.vue",{name:t.name,id:t.id},"统计"):"metric"===i?Object(n.l)("equipmentDashboard"+t.id,"dashboard/dashboard.vue",{name:t.name+"指标数据统计",eid:t.id,id:"y_qMB3IBmkPMjFRE7O-_",type:"EQedit"},"查看"):layer.msg(i+" 类型资产暂无报表",{icon:5})},equipmentDashboard:function(t,e){Object(n.l)("equipmentDashboard"+t.id,"dashboard/dashboard.vue",{name:t.name+"指标数据统计",eid:t.id,id:"y_qMB3IBmkPMjFRE7O-_",type:"EQedit"},"修改")},equipmentEvents:function(t,e){Object(n.l)("equipmentEvents2"+t.id,"eventManage/equipmentEvents2.vue",{name:t.name,id:t.id},"事件")},setSafe:function(t,e){Object(n.l)("equipmentSafe"+t.id,"equipment/equipmentSafe.vue",{name:t.name,id:t.id,logType:t.logType},"安全策略")},theartAnalyse:function(t,e){Object(n.l)("equipmentThreat"+t.id,"equipment/equipmentThreat.vue",{name:t.name,id:t.id,logType:t.logType},"威胁分析")},liMouseenter:function(t){var e=t.currentTarget;$(e).find(".eq-more").css({padding:"0 8px",borderWidth:"1",width:"auto"})},liMouseleave:function(t){var e=t.currentTarget;$(e).find(".eq-more").css({padding:"0",borderWidth:"0",width:"0"})},spanMouseenter:function(t){var e=t.currentTarget,i=$(e).offset().left,s=$(".eq-wapper").width();$(e).css("zIndex","5"),this.zzIndex=2,s-i<188?$(e).next().css({zIndex:"4",opacity:"1",right:"50px"}):$(e).next().css({zIndex:"4",opacity:"1",right:"-220px"})},spanMouseleave:function(t){$(e).css("zIndex","1"),this.zzIndex=-2;var e=t.currentTarget;$(e).next().css({zIndex:"-1",opacity:"0",right:"-240px"})},downLoadEq:function(){var t=document.getElementById("eqDownload");t.href=this.$baseUrl+"/equipment/equipmentDownload.do",t.click()}},watch:{importState:function(){var t=this;!0===this.importState&&setTimeout(function(){var e=t;$("#ssi-upload").ssi_uploader({url:t.$baseUrl+"/equipment/insertEquipmentUpload.do",maxNumberOfFiles:1,allowed:["xlsx","xls","xlsm"],ajaxOptions:{success:function(t){var i=JSON.parse(t);e.backState=!0,e.backStateObj={state:i.success,text:i.message}},error:function(t){layer.msg("导入失败",{icon:5}),$(".ssi-abortUpload").click()}}})},100)}},beforeRouteEnter:function(t,e,i){i(function(e){void 0!==t.params.equipmentid?(e.selectEquipmentId=t.params.equipmentid,e.selectEquipment(),e.c_page=1):void 0!==t.params.groupId?(e.searchConditions.asset_group_id=t.params.groupId,e.formConditionsArr[e.formConditionsArr.length-2].model.model=t.params.groupId,e.getData(e.searchConditions,e.c_page),e.c_page=1):""!==e.selectEquipmentId?(e.selectEquipment(),e.c_page=1):e.getData(e.searchConditions,e.c_page)})},components:{vSearchForm:s.default}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content-bg"},[i("div",{staticClass:"top-title"},[t._v("资产概览\n            "),i("div",{staticClass:"equipment-tools"},[i("div",{staticClass:"equipemnt-tools-btns"},[i("el-button",{attrs:{type:"info",size:"mini",plain:""}},[i("a",{attrs:{id:"eqDownload"},on:{click:t.downLoadEq}},[t._v("模板下载")])]),t._v(" "),i("el-button",{attrs:{type:"warning",size:"mini",plain:""},on:{click:function(e){return t.importEquipment()}}},[t._v("资产导入")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:t.goToAddEquipment}},[t._v("添加资产")]),t._v(" "),i("el-button",{attrs:{type:"danger",size:"mini",plain:""},on:{click:t.removeEquipment}},[t._v("删除资产")]),t._v(" "),i("el-button",{attrs:{type:"success",size:"mini",plain:""},on:{click:t.refreshEq}},[t._v("刷新")])],1)])]),t._v(" "),i("div",{staticClass:"equipemnt-tools-form"},[i("v-search-form",{attrs:{formItem:t.formConditionsArr,busName:t.busName}})],1),t._v(" "),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"eq-wapper",attrs:{"element-loading-background":"rgba(48, 62, 78, 0.5)"}},[i("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},[i("ul",{staticClass:"eq-ul"},t._l(t.equipmentList,function(e,s){return i("li",{key:s,staticClass:"eq-li",on:{mouseenter:function(e){return t.liMouseenter(e)},mouseleave:function(e){return t.liMouseleave(e)},"":function(t){}}},[i("div",{staticClass:"eq-tools-01"},[i("i",{staticClass:"el-icon-edit ",attrs:{title:"修改资产"},on:{click:function(i){return t.reviseEquipment(e)}}}),t._v(" "),i("span",[t._v("\n                            今日: "),i("b",{attrs:{title:"今日日志数"}},[t._v(t._s(e.log_count))])]),t._v(" "),i("el-checkbox",{attrs:{label:e.id}})],1),t._v(" "),i("div",{staticClass:"eq-name"},[i("span",{staticClass:"eq-name-span"},[t._v(t._s(e.name))]),t._v(" "),i("span",{staticClass:"eq-t-span"},[t._v(t._s(e.type))])]),t._v(" "),i("div",{staticClass:"eq-type"},[i("i",{staticClass:"el-icon-s-data go_metric",attrs:{title:"查看资产报表"},on:{click:function(i){return t.equipmentEcharts(e)}}})]),t._v(" "),i("div",{staticClass:"eq-inf"},[i("span",{staticClass:"eq-logtype"},[t._v(t._s(e.logType))]),t._v(" "),i("span",{staticClass:"eq-ip"},[t._v(t._s(e.ip))]),t._v(" "),i("span",{staticClass:"eq-more",on:{mouseenter:function(e){return t.spanMouseenter(e)},mouseleave:function(e){return t.spanMouseleave(e)}}},[i("i",{staticClass:"el-icon-arrow-right"})]),t._v(" "),i("ul",{staticClass:"inf-ul"},[i("li",{staticClass:"inf-logtype"},[i("div",{staticClass:"inf-tit"},[t._v("日志类型：")]),t._v(" "),i("div",{staticClass:"inf-val"},[t._v(t._s(e.logType))])]),t._v(" "),i("li",{staticClass:"inf-ip"},[i("div",{staticClass:"inf-tit"},[t._v("IP地址：")]),t._v(" "),i("div",{staticClass:"inf-val"},[t._v(t._s(e.ip))])]),t._v(" "),i("li",{staticClass:"inf-hostname"},[i("div",{staticClass:"inf-tit"},[t._v("主机名：")]),t._v(" "),i("div",{staticClass:"inf-val"},[t._v(t._s(e.hostName))])]),t._v(" "),i("li",{staticClass:"inf-type"},[i("div",{staticClass:"inf-tit"},[t._v("资产类型：")]),t._v(" "),i("div",{staticClass:"inf-val"},[t._v(t._s(e.type))])]),t._v(" "),i("li",{staticClass:"inf-domain"},[i("div",{staticClass:"inf-tit"},[t._v("根域名：")]),t._v(" "),i("div",{staticClass:"inf-val"},[t._v(t._s(e.domain))])]),t._v(" "),i("li",{staticClass:"inf-port"},[i("div",{staticClass:"inf-tit"},[t._v("端口：")]),t._v(" "),i("div",{staticClass:"inf-val"},[t._v(t._s(e.port))])]),t._v(" "),i("li",{staticClass:"inf-iswork"},[i("div",{staticClass:"inf-tit"},[t._v("是否启用：")]),t._v(" "),i("div",{staticClass:"inf-val"},[t._v(t._s("1"==e.startUp?"是":"否"))])]),t._v(" "),i("li",{staticClass:"inf-starttime"},[i("div",{staticClass:"inf-tit"},[t._v("创建时间：")]),t._v(" "),i("div",{staticClass:"inf-val"},[t._v(t._s(e.createTime))])]),t._v(" "),i("li",{staticClass:"inf-updatetime"},[i("div",{staticClass:"inf-tit"},[t._v("更新时间：")]),t._v(" "),i("div",{staticClass:"inf-val"},[t._v(t._s(e.updateTime))])]),t._v(" "),i("li",{staticClass:"inf-endtime"},[i("div",{staticClass:"inf-tit"},[t._v("停用时间：")]),t._v(" "),i("div",{staticClass:"inf-val"},[t._v(t._s(e.endTime))])])])]),t._v(" "),i("div",{staticClass:"eq-tools-02"},[i("i",{staticClass:"el-icon-tickets",attrs:{title:"查看资产日志"},on:{click:function(i){return t.equipmentLogs(e)}}}),t._v(" "),i("i",{staticClass:"el-icon-date",attrs:{title:"查看资产事件"},on:{click:function(i){return t.equipmentEvents(e)}}}),t._v(" "),i("i",{staticClass:"el-icon-bell",attrs:{title:"设置安全策略"},on:{click:function(i){return t.setSafe(e)}}}),t._v(" "),i("i",{staticClass:"el-icon-view",style:{color:0!==e.high_risk?"#f55446":0!==e.moderate_risk?"#f1ae09":"#4995bb"},attrs:{title:"潜在威胁分析"},on:{click:function(i){return t.theartAnalyse(e)}}})])])}),0)])],1),t._v(" "),i("div",{staticClass:"equipment-table-page"},[i("span",[t._v("共检索到资产数量为 "),i("b",[t._v(t._s(t.allCounts))]),t._v(" 台")]),t._v(" "),i("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":t.c_page,"page-size":t.size,total:t.allCounts},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.c_page=e},"update:current-page":function(e){t.c_page=e}}})],1),t._v(" "),i("div",{staticClass:"zz-box",style:{zIndex:t.zzIndex}}),t._v(" "),i("el-dialog",{staticClass:"dialog-wapper",attrs:{title:"资产导入",visible:t.importState,width:"680px",height:"550px"},on:{"update:visible":function(e){t.importState=e}}},[t.backState?i("div",{staticClass:"back-state"},[i("p",{staticClass:"i-box"},["true"==this.backStateObj.state?i("i",{staticClass:"el-icon-success",staticStyle:{color:"#279e72"}}):i("i",{staticClass:"el-icon-error",staticStyle:{color:"#e27145"}})]),t._v(" "),"true"==this.backStateObj.state?i("h3",{staticClass:"back-h3",staticStyle:{color:"#279e72"}},[t._v("导入成功")]):i("h3",{staticClass:"back-h3",staticStyle:{color:"#e27145"}},[t._v("导入失败")]),t._v(" "),i("p",{staticClass:"back-text"},[t._v(t._s(this.backStateObj.text))]),t._v(" "),i("p",{staticClass:"back-btn"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.backState=!1}}},[t._v("返回导入界面")])],1)]):t._e(),t._v(" "),i("p",[t._v("通过浏览本地文件或将文件拖到下面指定区域，上传资产文件。")]),t._v(" "),i("p",[t._v("文件支持的类型："),i("span",{staticClass:"txtColor"},[t._v(".xlsx")]),t._v(" "),i("span",{staticClass:"txtColor"},[t._v(".xls")]),t._v(" "),i("span",{staticClass:"txtColor"},[t._v(".xlsm")])]),t._v(" "),i("p",[t._v("文件的名称必须为："),i("span",{staticClass:"txtColor"},[t._v("资产清单")]),t._v("  (例:资产清单.xlsx)")]),t._v(" "),i("div",{staticStyle:{"padding-right":"30px"}},[i("input",{attrs:{type:"file",multiple:"",id:"ssi-upload"}})]),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.importState=!1}}},[t._v("取 消")])],1)])],1)},staticRenderFns:[]};var c=i("VU/8")(o,l,!1,function(t){i("VbHu")},"data-v-3eff45b8",null);e.default=c.exports},VbHu:function(t,e){}});