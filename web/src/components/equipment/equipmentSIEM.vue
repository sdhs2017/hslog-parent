<template>
    <div class="content-bg">
        <div class="top-title">{{this.equipmentname}}
            <div class="date-wapper">
<!--                <datebase type="datetimerange" :busName="busName" :default-val="defaultDate"></datebase>-->
                <dateLayout style="margin-top: 9px;" :busName="busName" :defaultVal="defaultDate"></dateLayout>

            </div>
        </div>
        <div class="chart-wapper" v-loading="loading"  element-loading-background="rgba(48, 62, 78, 0.5)">
            <customChart :chartData="chartData"></customChart>
        </div>
    </div>
</template>

<script>
    import customChart from '../common/customChart'
    import dateLayout from '../common/dateLayout'
    import bus from '../common/bus'
    import {dateFormat,setChartParam} from "../../../static/js/common";
    export default {
        name: "equipmentSIEM",
        data(){
            return{
                loading:false,
                equipmentId:'',
                equipmentname:'',
                defaultDate:{
                    //具体时间参数
                    lastVal:'1-day',
                    //起始时间
                    starttime:'',
                    //结束时间
                    endtime:'',
                    //具体时间 类型状态
                    dateBlock:false,
                    //是否存在轮询框
                    isIntervalBox:false,
                    //轮询状态
                    intervalState:false,
                    //轮询数值间隔
                    intervalVal:'',
                    //轮询参数类型
                    intervalType:'',
                    //‘快速选择’功能参数类型
                    dateUnit:'day',
                    //‘快速选择’功能参数数值
                    dateCount:'1',
                    //‘常用’ 时间值
                    commonlyVal:'',
                    //是否可以切换精确日期
                    changeState:true
                },
                starttime:'',
                endtime:'',
                last:'1-day',
                busName:'equipmentSIEM',
                chartData:{},
               // chartData:{"事件27":[{"start":"2021-01-01 12:15:25","end":"2021-01-01 17:42:52","count":13},{"start":"2021-01-01 20:34:14","end":"2021-01-03 18:28:50","count":68},{"start":"2021-01-03 21:33:06","end":"2021-01-07 02:27:23","count":121},{"start":"2021-01-07 05:09:12","end":"2021-01-07 05:32:44","count":2}],"事件28":[{"start":"2021-01-01 12:13:40","end":"2021-01-02 08:12:12","count":30},{"start":"2021-01-02 11:35:48","end":"2021-01-05 05:26:49","count":112},{"start":"2021-01-05 07:58:28","end":"2021-01-05 23:40:24","count":24},{"start":"2021-01-06 02:14:08","end":"2021-01-06 17:49:56","count":27},{"start":"2021-01-06 20:21:24","end":"2021-01-07 05:13:08","count":13}],"事件29":[{"start":"2021-01-01 12:54:10","end":"2021-01-01 15:56:33","count":8},{"start":"2021-01-01 18:29:28","end":"2021-01-02 21:11:14","count":56},{"start":"2021-01-02 23:54:51","end":"2021-01-04 01:50:21","count":41},{"start":"2021-01-04 05:45:11","end":"2021-01-04 06:19:51","count":2},{"start":"2021-01-04 09:36:46","end":"2021-01-04 15:36:26","count":12},{"start":"2021-01-04 18:35:54","end":"2021-01-05 03:35:49","count":13},{"start":"2021-01-05 06:55:46","end":"2021-01-05 16:48:06","count":15},{"start":"2021-01-05 20:09:39","end":"2021-01-06 10:02:00","count":29},{"start":"2021-01-06 15:59:23","end":"2021-01-06 22:30:34","count":10},{"start":"2021-01-07 01:02:22","end":"2021-01-07 05:43:09","count":10}],"事件23":[{"start":"2021-01-01 12:07:42","end":"2021-01-02 03:32:12","count":17},{"start":"2021-01-02 06:51:14","end":"2021-01-03 00:02:40","count":35},{"start":"2021-01-03 02:37:56","end":"2021-01-03 19:07:22","count":27},{"start":"2021-01-03 21:39:37","end":"2021-01-04 20:15:07","count":44},{"start":"2021-01-04 22:56:24","end":"2021-01-05 03:12:29","count":11},{"start":"2021-01-05 05:51:26","end":"2021-01-05 08:36:11","count":8},{"start":"2021-01-05 11:29:55","end":"2021-01-05 17:09:58","count":7},{"start":"2021-01-05 20:10:38","end":"2021-01-07 05:08:27","count":45}],"事件24":[{"start":"2021-01-01 12:27:21","end":"2021-01-03 06:42:05","count":70},{"start":"2021-01-03 09:12:30","end":"2021-01-07 02:18:20","count":141},{"start":"2021-01-07 04:53:02","end":"2021-01-07 05:07:54","count":2}],"事件25":[{"start":"2021-01-01 12:47:52","end":"2021-01-02 17:12:06","count":49},{"start":"2021-01-02 20:02:26","end":"2021-01-03 11:28:26","count":19},{"start":"2021-01-03 14:06:32","end":"2021-01-04 00:51:51","count":16},{"start":"2021-01-04 03:30:01","end":"2021-01-04 12:19:43","count":16},{"start":"2021-01-04 16:58:29","end":"2021-01-05 02:45:03","count":17},{"start":"2021-01-05 06:38:10","end":"2021-01-07 05:24:08","count":70}],"事件26":[{"start":"2021-01-01 12:21:59","end":"2021-01-03 18:23:50","count":84},{"start":"2021-01-03 21:21:13","end":"2021-01-04 17:46:27","count":32},{"start":"2021-01-04 23:20:23","end":"2021-01-07 04:53:32","count":89}],"事件20":[{"start":"2021-01-01 12:16:14","end":"2021-01-02 07:21:30","count":40},{"start":"2021-01-02 10:20:56","end":"2021-01-02 21:59:04","count":17},{"start":"2021-01-03 01:06:13","end":"2021-01-03 14:07:50","count":21},{"start":"2021-01-03 17:16:27","end":"2021-01-04 12:38:21","count":31},{"start":"2021-01-04 15:42:38","end":"2021-01-04 21:41:19","count":9},{"start":"2021-01-05 00:22:53","end":"2021-01-05 02:24:27","count":2},{"start":"2021-01-05 04:56:47","end":"2021-01-05 17:24:12","count":18},{"start":"2021-01-05 19:58:25","end":"2021-01-06 03:54:06","count":13},{"start":"2021-01-06 07:28:33","end":"2021-01-06 07:40:51","count":2},{"start":"2021-01-06 10:17:15","end":"2021-01-06 23:04:46","count":23},{"start":"2021-01-07 01:41:28","end":"2021-01-07 05:18:35","count":8}],"事件21":[{"start":"2021-01-01 12:33:00","end":"2021-01-02 06:44:58","count":32},{"start":"2021-01-02 10:01:10","end":"2021-01-03 13:17:54","count":46},{"start":"2021-01-03 16:27:37","end":"2021-01-04 05:21:52","count":22},{"start":"2021-01-04 07:56:25","end":"2021-01-06 01:57:25","count":56},{"start":"2021-01-06 05:31:36","end":"2021-01-07 05:21:23","count":40}],"事件22":[{"start":"2021-01-01 12:27:35","end":"2021-01-01 17:29:11","count":11},{"start":"2021-01-01 20:32:47","end":"2021-01-04 05:02:08","count":87},{"start":"2021-01-04 07:54:18","end":"2021-01-05 00:13:33","count":32},{"start":"2021-01-05 02:51:19","end":"2021-01-05 10:50:06","count":17},{"start":"2021-01-05 13:33:01","end":"2021-01-06 01:49:51","count":23},{"start":"2021-01-06 05:09:35","end":"2021-01-07 02:19:36","count":33}],"事件38":[{"start":"2021-01-01 12:43:45","end":"2021-01-03 21:17:03","count":92},{"start":"2021-01-04 00:11:45","end":"2021-01-04 14:14:19","count":24},{"start":"2021-01-04 17:10:52","end":"2021-01-05 10:02:36","count":23},{"start":"2021-01-05 12:48:25","end":"2021-01-06 06:38:26","count":28},{"start":"2021-01-06 10:02:27","end":"2021-01-07 05:06:29","count":29}],"事件39":[{"start":"2021-01-01 12:41:43","end":"2021-01-01 18:09:22","count":8},{"start":"2021-01-01 20:39:39","end":"2021-01-03 07:31:47","count":59},{"start":"2021-01-03 10:58:05","end":"2021-01-03 21:28:43","count":22},{"start":"2021-01-04 00:21:07","end":"2021-01-05 02:52:57","count":36},{"start":"2021-01-05 06:14:57","end":"2021-01-06 06:28:04","count":33},{"start":"2021-01-06 12:14:21","end":"2021-01-06 17:44:58","count":7},{"start":"2021-01-06 21:15:51","end":"2021-01-07 05:43:53","count":16}],"事件34":[{"start":"2021-01-01 12:15:17","end":"2021-01-01 18:09:15","count":12},{"start":"2021-01-01 20:43:52","end":"2021-01-02 15:01:54","count":27},{"start":"2021-01-02 17:35:01","end":"2021-01-03 13:17:08","count":35},{"start":"2021-01-03 15:50:13","end":"2021-01-04 08:18:14","count":31},{"start":"2021-01-04 12:03:16","end":"2021-01-06 02:23:58","count":66},{"start":"2021-01-06 05:39:30","end":"2021-01-06 16:46:20","count":23},{"start":"2021-01-06 19:40:30","end":"2021-01-07 02:55:26","count":9},{"start":"2021-01-07 05:30:22","end":null,"count":1}],"事件35":[{"start":"2021-01-01 13:53:00","end":"2021-01-04 06:37:17","count":100},{"start":"2021-01-04 09:37:54","end":"2021-01-06 16:38:34","count":77},{"start":"2021-01-06 19:13:53","end":"2021-01-07 05:16:40","count":18}],"事件36":[{"start":"2021-01-01 12:20:28","end":"2021-01-04 04:00:49","count":94},{"start":"2021-01-04 07:34:46","end":"2021-01-04 15:39:43","count":20},{"start":"2021-01-04 20:16:06","end":"2021-01-07 05:35:09","count":87}],"事件37":[{"start":"2021-01-01 12:20:00","end":"2021-01-02 09:43:30","count":35},{"start":"2021-01-02 13:04:54","end":"2021-01-02 23:34:29","count":14},{"start":"2021-01-03 02:28:39","end":"2021-01-03 10:57:29","count":19},{"start":"2021-01-03 13:38:43","end":"2021-01-04 02:17:10","count":27},{"start":"2021-01-04 05:58:23","end":"2021-01-05 10:35:43","count":49},{"start":"2021-01-05 13:10:30","end":"2021-01-06 09:41:49","count":38},{"start":"2021-01-06 12:19:41","end":"2021-01-07 05:28:59","count":30}],"事件30":[{"start":"2021-01-01 16:46:06","end":"2021-01-01 23:24:32","count":14},{"start":"2021-01-02 02:23:03","end":"2021-01-02 08:52:35","count":11},{"start":"2021-01-02 11:48:03","end":"2021-01-02 17:26:57","count":10},{"start":"2021-01-02 20:11:22","end":"2021-01-03 21:44:46","count":45},{"start":"2021-01-04 00:55:34","end":"2021-01-07 05:14:32","count":114}],"事件31":[{"start":"2021-01-01 12:51:53","end":"2021-01-03 13:32:51","count":97},{"start":"2021-01-03 16:28:35","end":"2021-01-03 16:35:48","count":2},{"start":"2021-01-03 19:39:30","end":"2021-01-04 21:14:38","count":34},{"start":"2021-01-04 23:46:55","end":"2021-01-05 00:48:11","count":2},{"start":"2021-01-05 03:41:46","end":"2021-01-05 05:49:44","count":6},{"start":"2021-01-05 08:48:15","end":"2021-01-05 11:49:01","count":3},{"start":"2021-01-05 14:35:11","end":"2021-01-06 19:54:32","count":40},{"start":"2021-01-06 23:16:07","end":"2021-01-06 23:44:27","count":2},{"start":"2021-01-07 02:42:33","end":"2021-01-07 05:26:43","count":5}],"事件32":[{"start":"2021-01-01 13:38:38","end":"2021-01-01 19:36:24","count":13},{"start":"2021-01-02 00:15:01","end":"2021-01-02 09:28:36","count":12},{"start":"2021-01-02 13:01:58","end":"2021-01-02 18:23:25","count":11},{"start":"2021-01-02 21:05:37","end":"2021-01-03 03:39:08","count":18},{"start":"2021-01-03 06:45:18","end":"2021-01-05 21:17:51","count":128},{"start":"2021-01-06 00:38:22","end":"2021-01-07 00:03:51","count":36},{"start":"2021-01-07 05:01:46","end":"2021-01-07 05:40:07","count":3}],"事件33":[{"start":"2021-01-01 12:15:20","end":"2021-01-01 13:25:27","count":3},{"start":"2021-01-01 16:29:26","end":"2021-01-01 18:55:53","count":5},{"start":"2021-01-01 22:20:34","end":"2021-01-02 09:12:24","count":28},{"start":"2021-01-02 11:42:56","end":"2021-01-04 13:48:36","count":99},{"start":"2021-01-04 16:37:07","end":"2021-01-05 01:31:20","count":14},{"start":"2021-01-05 04:04:37","end":"2021-01-07 05:37:23","count":86}],"事件49":[{"start":"2021-01-01 12:36:38","end":"2021-01-02 15:32:05","count":42},{"start":"2021-01-02 18:14:04","end":"2021-01-03 20:28:52","count":45},{"start":"2021-01-03 23:03:14","end":"2021-01-04 07:40:48","count":9},{"start":"2021-01-04 10:15:34","end":"2021-01-05 06:29:57","count":29},{"start":"2021-01-05 09:53:29","end":"2021-01-05 09:54:16","count":2},{"start":"2021-01-05 13:07:59","end":"2021-01-05 15:48:57","count":9},{"start":"2021-01-05 18:47:48","end":"2021-01-06 07:16:18","count":19},{"start":"2021-01-06 09:49:44","end":"2021-01-06 13:53:54","count":8},{"start":"2021-01-06 17:27:15","end":"2021-01-07 04:50:39","count":27}],"事件45":[{"start":"2021-01-01 12:04:20","end":"2021-01-02 00:27:30","count":19},{"start":"2021-01-02 05:32:02","end":"2021-01-03 01:00:24","count":36},{"start":"2021-01-03 04:08:08","end":"2021-01-05 22:37:06","count":107},{"start":"2021-01-06 02:28:52","end":"2021-01-07 04:34:12","count":44}],"事件46":[{"start":"2021-01-01 12:33:51","end":"2021-01-01 13:12:09","count":2},{"start":"2021-01-01 16:58:12","end":"2021-01-01 22:50:38","count":8},{"start":"2021-01-02 01:25:07","end":"2021-01-02 02:18:28","count":3},{"start":"2021-01-02 04:53:41","end":"2021-01-06 00:37:55","count":160},{"start":"2021-01-06 03:53:23","end":"2021-01-06 14:20:33","count":21},{"start":"2021-01-06 17:00:33","end":"2021-01-06 21:59:05","count":11},{"start":"2021-01-07 01:36:48","end":"2021-01-07 04:21:35","count":4}],"事件47":[{"start":"2021-01-01 12:22:35","end":"2021-01-02 16:39:47","count":50},{"start":"2021-01-02 20:28:18","end":"2021-01-03 06:56:55","count":18},{"start":"2021-01-03 09:30:09","end":"2021-01-04 21:18:02","count":52},{"start":"2021-01-04 23:51:57","end":"2021-01-06 07:56:57","count":66},{"start":"2021-01-06 11:33:51","end":"2021-01-07 05:04:40","count":24}],"事件48":[{"start":"2021-01-01 12:12:32","end":"2021-01-02 00:33:57","count":22},{"start":"2021-01-02 03:41:46","end":"2021-01-02 07:09:22","count":9},{"start":"2021-01-02 10:16:43","end":"2021-01-02 13:16:43","count":9},{"start":"2021-01-02 19:31:03","end":"2021-01-02 22:52:30","count":4},{"start":"2021-01-03 01:23:59","end":"2021-01-03 13:46:18","count":21},{"start":"2021-01-03 16:22:07","end":"2021-01-06 15:45:32","count":110},{"start":"2021-01-06 18:27:33","end":"2021-01-07 04:14:25","count":15}],"事件41":[{"start":"2021-01-01 12:37:45","end":"2021-01-01 13:07:02","count":2},{"start":"2021-01-01 16:08:29","end":"2021-01-02 15:55:20","count":36},{"start":"2021-01-02 18:58:30","end":"2021-01-02 23:22:25","count":7},{"start":"2021-01-03 02:13:37","end":"2021-01-03 02:26:52","count":4},{"start":"2021-01-03 05:09:43","end":"2021-01-04 19:17:53","count":68},{"start":"2021-01-04 22:39:40","end":"2021-01-05 23:54:46","count":40},{"start":"2021-01-06 02:46:44","end":"2021-01-07 00:41:49","count":51},{"start":"2021-01-07 03:16:26","end":"2021-01-07 05:22:40","count":6}],"事件42":[{"start":"2021-01-01 13:23:29","end":"2021-01-01 22:10:26","count":14},{"start":"2021-01-02 01:59:28","end":"2021-01-03 10:48:18","count":56},{"start":"2021-01-03 14:04:08","end":"2021-01-05 07:38:39","count":66},{"start":"2021-01-05 10:19:29","end":"2021-01-05 15:04:13","count":11},{"start":"2021-01-05 17:40:29","end":"2021-01-06 02:31:03","count":14},{"start":"2021-01-06 05:39:01","end":"2021-01-06 15:05:37","count":17},{"start":"2021-01-06 19:26:42","end":"2021-01-07 05:03:25","count":25}],"事件43":[{"start":"2021-01-01 12:43:10","end":"2021-01-02 08:00:37","count":40},{"start":"2021-01-02 10:39:38","end":"2021-01-02 15:14:32","count":4},{"start":"2021-01-02 21:40:48","end":"2021-01-03 05:50:40","count":15},{"start":"2021-01-03 08:25:00","end":"2021-01-03 14:48:46","count":11},{"start":"2021-01-03 17:47:10","end":"2021-01-07 05:45:57","count":135}],"事件44":[{"start":"2021-01-01 13:58:33","end":"2021-01-01 23:07:49","count":21},{"start":"2021-01-02 02:34:59","end":"2021-01-02 09:32:25","count":11},{"start":"2021-01-02 12:24:19","end":"2021-01-03 16:12:30","count":58},{"start":"2021-01-03 19:13:45","end":"2021-01-04 07:08:31","count":20},{"start":"2021-01-04 10:06:12","end":"2021-01-06 06:30:59","count":78},{"start":"2021-01-06 09:56:39","end":"2021-01-07 05:28:01","count":38}],"事件40":[{"start":"2021-01-01 12:02:07","end":"2021-01-02 02:37:28","count":20},{"start":"2021-01-02 05:32:47","end":"2021-01-03 16:24:01","count":52},{"start":"2021-01-03 19:04:54","end":"2021-01-05 10:42:59","count":70},{"start":"2021-01-05 13:24:06","end":"2021-01-07 05:41:36","count":69}],"事件16":[{"start":"2021-01-01 13:56:07","end":"2021-01-02 01:39:00","count":18},{"start":"2021-01-02 04:52:02","end":"2021-01-02 19:27:12","count":29},{"start":"2021-01-02 22:58:25","end":"2021-01-03 04:36:06","count":10},{"start":"2021-01-03 08:28:56","end":"2021-01-03 13:06:00","count":9},{"start":"2021-01-03 15:43:24","end":"2021-01-05 07:13:34","count":67},{"start":"2021-01-05 09:44:07","end":"2021-01-06 09:04:29","count":38},{"start":"2021-01-06 13:07:11","end":"2021-01-07 04:18:18","count":21}],"事件17":[{"start":"2021-01-01 13:03:26","end":"2021-01-02 00:58:16","count":14},{"start":"2021-01-02 05:12:46","end":"2021-01-04 06:00:06","count":72},{"start":"2021-01-04 08:47:46","end":"2021-01-05 00:26:27","count":24},{"start":"2021-01-05 03:01:51","end":"2021-01-05 08:29:51","count":10},{"start":"2021-01-05 12:41:49","end":"2021-01-06 00:36:12","count":25},{"start":"2021-01-06 04:53:24","end":"2021-01-07 05:37:09","count":45}],"事件18":[{"start":"2021-01-01 12:43:11","end":"2021-01-03 06:37:37","count":78},{"start":"2021-01-03 09:48:46","end":"2021-01-03 20:36:36","count":15},{"start":"2021-01-03 23:19:16","end":"2021-01-04 00:04:43","count":3},{"start":"2021-01-04 02:38:25","end":"2021-01-04 19:26:45","count":32},{"start":"2021-01-04 22:11:12","end":"2021-01-05 05:12:39","count":10},{"start":"2021-01-05 09:49:15","end":"2021-01-06 18:39:40","count":56},{"start":"2021-01-06 21:23:52","end":"2021-01-06 21:39:18","count":2},{"start":"2021-01-07 00:24:46","end":"2021-01-07 05:44:40","count":14}],"事件19":[{"start":"2021-01-01 12:28:50","end":"2021-01-02 10:01:56","count":31},{"start":"2021-01-02 13:11:02","end":"2021-01-03 01:56:19","count":16},{"start":"2021-01-03 05:35:19","end":"2021-01-04 02:40:22","count":31},{"start":"2021-01-04 05:44:24","end":"2021-01-05 00:01:21","count":32},{"start":"2021-01-05 03:22:50","end":"2021-01-07 05:22:59","count":85}],"事件12":[{"start":"2021-01-01 12:09:57","end":"2021-01-02 16:25:50","count":41},{"start":"2021-01-02 19:03:23","end":"2021-01-03 13:42:27","count":35},{"start":"2021-01-03 17:55:11","end":"2021-01-05 11:04:32","count":60},{"start":"2021-01-05 15:16:59","end":"2021-01-06 10:57:01","count":32},{"start":"2021-01-06 14:00:24","end":"2021-01-06 18:39:14","count":10},{"start":"2021-01-06 21:14:02","end":"2021-01-07 04:47:43","count":10}],"事件13":[{"start":"2021-01-01 12:48:15","end":"2021-01-02 12:07:28","count":38},{"start":"2021-01-02 15:07:09","end":"2021-01-03 01:41:06","count":19},{"start":"2021-01-03 05:25:09","end":"2021-01-05 06:42:36","count":81},{"start":"2021-01-05 09:41:32","end":"2021-01-05 10:27:35","count":5},{"start":"2021-01-05 13:09:23","end":"2021-01-05 18:07:37","count":8},{"start":"2021-01-05 21:38:34","end":"2021-01-07 00:40:30","count":43},{"start":"2021-01-07 04:19:31","end":"2021-01-07 04:52:32","count":2}],"事件14":[{"start":"2021-01-01 12:14:06","end":"2021-01-04 04:03:24","count":93},{"start":"2021-01-04 06:39:53","end":"2021-01-05 01:39:53","count":28},{"start":"2021-01-05 04:44:58","end":"2021-01-07 05:11:08","count":77}],"事件15":[{"start":"2021-01-01 12:18:24","end":"2021-01-02 13:06:42","count":47},{"start":"2021-01-02 16:19:25","end":"2021-01-03 13:18:00","count":33},{"start":"2021-01-03 16:09:21","end":"2021-01-05 11:36:40","count":76},{"start":"2021-01-05 14:57:48","end":"2021-01-06 02:42:11","count":27},{"start":"2021-01-06 06:02:55","end":"2021-01-06 08:49:54","count":3},{"start":"2021-01-06 12:01:15","end":"2021-01-07 05:11:57","count":28}],"事件0":[{"start":"2021-01-01 12:00:30","end":"2021-01-02 05:51:13","count":23},{"start":"2021-01-02 09:38:28","end":"2021-01-04 08:53:45","count":79},{"start":"2021-01-04 11:28:04","end":"2021-01-07 05:15:22","count":107}],"事件10":[{"start":"2021-01-01 12:40:03","end":"2021-01-01 14:56:32","count":8},{"start":"2021-01-01 17:34:17","end":"2021-01-01 20:23:21","count":8},{"start":"2021-01-01 23:40:15","end":"2021-01-02 09:43:24","count":14},{"start":"2021-01-02 12:27:39","end":"2021-01-02 20:48:08","count":13},{"start":"2021-01-02 23:49:02","end":"2021-01-04 16:17:05","count":55},{"start":"2021-01-04 19:52:16","end":"2021-01-05 08:10:03","count":31},{"start":"2021-01-05 10:54:20","end":"2021-01-06 11:30:58","count":43},{"start":"2021-01-06 17:01:22","end":"2021-01-07 05:23:47","count":25}],"事件1":[{"start":"2021-01-01 12:44:42","end":"2021-01-01 19:20:07","count":15},{"start":"2021-01-01 21:51:53","end":"2021-01-03 02:16:10","count":36},{"start":"2021-01-03 05:17:07","end":"2021-01-03 18:30:53","count":19},{"start":"2021-01-04 00:42:31","end":"2021-01-04 22:06:39","count":34},{"start":"2021-01-05 01:22:25","end":"2021-01-06 18:52:06","count":70},{"start":"2021-01-06 22:03:50","end":"2021-01-07 05:25:20","count":12}],"事件11":[{"start":"2021-01-01 12:02:37","end":"2021-01-01 22:46:55","count":21},{"start":"2021-01-02 01:30:50","end":"2021-01-02 01:38:51","count":2},{"start":"2021-01-02 05:00:50","end":"2021-01-02 21:41:51","count":26},{"start":"2021-01-03 00:26:05","end":"2021-01-03 03:21:45","count":5},{"start":"2021-01-03 06:05:16","end":"2021-01-04 17:09:52","count":49},{"start":"2021-01-04 20:35:52","end":"2021-01-07 03:20:34","count":87}],"事件2":[{"start":"2021-01-01 12:10:56","end":"2021-01-03 17:08:17","count":90},{"start":"2021-01-03 20:32:56","end":"2021-01-05 00:44:52","count":40},{"start":"2021-01-05 03:52:39","end":"2021-01-05 05:21:34","count":3},{"start":"2021-01-05 10:03:54","end":"2021-01-05 13:25:49","count":12},{"start":"2021-01-05 16:05:53","end":"2021-01-06 13:22:51","count":41},{"start":"2021-01-06 15:53:15","end":"2021-01-06 17:13:45","count":5},{"start":"2021-01-06 20:29:14","end":"2021-01-07 05:09:48","count":18}],"事件3":[{"start":"2021-01-01 17:53:05","end":"2021-01-02 03:18:47","count":16},{"start":"2021-01-02 06:46:07","end":"2021-01-05 03:19:44","count":102},{"start":"2021-01-05 07:42:51","end":"2021-01-06 16:47:48","count":59},{"start":"2021-01-06 19:44:59","end":"2021-01-07 04:49:05","count":19}],"事件4":[{"start":"2021-01-01 12:06:13","end":"2021-01-02 07:12:40","count":23},{"start":"2021-01-02 09:43:11","end":"2021-01-03 01:14:53","count":21},{"start":"2021-01-03 04:02:46","end":"2021-01-03 11:21:16","count":10},{"start":"2021-01-03 14:18:31","end":"2021-01-04 00:58:15","count":14},{"start":"2021-01-04 03:41:27","end":"2021-01-04 10:29:25","count":10},{"start":"2021-01-04 13:59:23","end":"2021-01-06 03:41:09","count":66},{"start":"2021-01-06 06:35:49","end":"2021-01-07 04:38:55","count":30}],"事件5":[{"start":"2021-01-01 12:51:42","end":"2021-01-01 15:52:31","count":4},{"start":"2021-01-01 18:50:57","end":"2021-01-02 04:26:02","count":14},{"start":"2021-01-02 06:59:57","end":"2021-01-03 12:03:01","count":44},{"start":"2021-01-03 14:58:54","end":"2021-01-04 11:01:51","count":24},{"start":"2021-01-04 14:32:31","end":"2021-01-05 13:37:55","count":45},{"start":"2021-01-05 16:25:03","end":"2021-01-06 05:56:31","count":19},{"start":"2021-01-06 08:28:00","end":"2021-01-07 04:30:17","count":32}],"事件6":[{"start":"2021-01-01 13:20:08","end":"2021-01-02 03:42:01","count":26},{"start":"2021-01-02 06:26:46","end":"2021-01-05 17:45:30","count":143},{"start":"2021-01-05 20:32:50","end":"2021-01-05 23:22:24","count":4},{"start":"2021-01-06 02:16:09","end":"2021-01-07 04:23:45","count":42}],"事件7":[{"start":"2021-01-01 15:12:54","end":"2021-01-03 12:15:52","count":71},{"start":"2021-01-03 16:14:43","end":"2021-01-03 17:37:30","count":6},{"start":"2021-01-03 20:30:49","end":"2021-01-04 10:23:13","count":26},{"start":"2021-01-04 13:06:25","end":"2021-01-06 00:01:59","count":56},{"start":"2021-01-06 02:32:52","end":"2021-01-06 12:30:36","count":14},{"start":"2021-01-06 15:35:57","end":"2021-01-07 03:06:45","count":21}],"事件8":[{"start":"2021-01-01 12:05:26","end":"2021-01-02 12:07:34","count":40},{"start":"2021-01-02 15:03:07","end":"2021-01-02 15:43:27","count":2},{"start":"2021-01-02 18:16:24","end":"2021-01-02 18:48:35","count":7},{"start":"2021-01-02 21:34:36","end":"2021-01-04 00:35:31","count":48},{"start":"2021-01-04 03:33:14","end":"2021-01-04 08:14:29","count":7},{"start":"2021-01-04 12:16:33","end":"2021-01-05 08:52:26","count":33},{"start":"2021-01-05 12:56:25","end":"2021-01-06 05:01:59","count":31},{"start":"2021-01-06 07:37:57","end":"2021-01-06 11:19:41","count":9},{"start":"2021-01-06 14:32:26","end":"2021-01-07 05:20:04","count":19}],"事件9":[{"start":"2021-01-01 12:44:11","end":"2021-01-02 11:50:15","count":31},{"start":"2021-01-02 14:39:05","end":"2021-01-04 17:07:09","count":72},{"start":"2021-01-04 20:12:32","end":"2021-01-05 07:44:08","count":23},{"start":"2021-01-05 10:41:57","end":"2021-01-05 14:16:07","count":5},{"start":"2021-01-05 17:36:06","end":"2021-01-06 20:04:35","count":40},{"start":"2021-01-06 23:17:08","end":"2021-01-07 05:22:44","count":9}]}
            }
        },
        created() {
            this.busName = 'equipmentSIEMBusName'+ this.$route.query.id;
            this.equipmentname = this.$route.query.name;
            this.equipmentId = this.$route.query.id;
           /* const end = new Date();
            const start = new Date();
            start.setTime(start.getTime() - 3600 * 1000 * 24 * 1);
            this.defaultDate=[start,end];
            this.endtime = dateFormat('yyyy-mm-dd HH:MM:SS',end)
            this.starttime = dateFormat('yyyy-mm-dd HH:MM:SS',start)*/

            bus.$on(this.busName,(obj)=>{
                //设置参数对应
                let arr = setChartParam(obj);
                this.barParam = arr[0];
                this.last = arr[0].last
                this.starttime = arr[0].starttime
                this.endtime = arr[0].endtime
                this.getData()
            })
            this.getData()
        },
        methods:{
            getData(){
                this.$nextTick(()=>{
                    this.loading = true;
                    this.$axios.post(this.$baseUrl+'/siem/getSIEMInfo.do',this.$qs.stringify({
                        equipment_id:this.equipmentId,
                        starttime:this.starttime,
                        endtime:this.endtime,
                        last:this.last
                    }))
                        .then(res=>{
                            this.loading = false;
                            let obj = res.data;
                            if(obj.success == 'true'){
                                this.chartData = obj.data
                            }else{
                                layer.msg(obj.message,{icon:5})
                            }
                        })
                        .catch(err=>{
                             this.loading = false;
                        })
                })
            }
        },
        beforeRouteEnter(to, from, next) {
            next (vm => {
                // 这里通过 vm 来访问组件实例解决了没有 this 的问题
                //修改此组件的name值
                vm.$options.name = 'equipmentSIEM'+ to.query.id;
                //修改data参数
                vm.equipmentName = to.query.name;
                //将路由存放在本地 用来刷新页面时添加路由
                let obj = {
                    path:'equipmentSIEM'+to.query.id,
                    component:'equipment/equipmentSIEM.vue',
                    title:'统计'
                }
                sessionStorage.setItem('/equipmentSIEM'+to.query.id,JSON.stringify(obj))
                if(vm.equipmentId === '' || vm.equipmentId !== to.query.id){
                    vm.equipmentId = to.query.id;
                }

            })

        },
        components:{
            customChart,
            dateLayout
        }
    }
</script>

<style scoped>
    .date-wapper{
        float: right;
        margin-right: 10px;
    }
    .chart-wapper{
        height: calc(100vh - 280px)
    }
</style>
