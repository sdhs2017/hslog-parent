webpackJsonp([11],{"Kos/":function(t,e){},Qiuk:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("/sA3"),s=["01","02","03","04","05","06","07","08","09","10","11","12"],n=["Sun.","Mon.","Tues.","Wed.","Thur.","Fri.","Sat."],r=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],l={name:"index",data:function(){return{loading:!1,date:"",hour:"",min:"",sec:"",allLogsTotle:"0",errorLogsTotle:"0",flowTotle:"0",timeVal:"7",timeArr:[{value:"7",label:"最近7天"},{value:"30",label:"最近30天"},{value:"90",label:"最近90天"},{value:"",label:"全部"}],echartData:{barData:{baseConfig:{title:"",xAxisName:"级别",yAxisName:"数量/条",rotate:"25",hoverText:"数量"},xAxisArr:[],yAxisArr:[]},pieData:{baseConfig:{title:"",hoverText:"百分比"},xAxisArr:[],yAxisArr:[]},lineData:{baseConfig:{title:"",xAxisName:"时间",yAxisName:"数量",hoverText:"日志数量"},xAxisArr:[],yAxisArr:[]}}}},created:function(){setInterval(this.setDate,1e3),this.getLogsTotle(),this.getFlowTotle(),this.getLineEchartData();var t=Object(i.a)("yyyy-mm-dd",new Date),e=Object(i.a)("yyyy-mm-dd",new Date((new Date).getTime()-24*this.timeVal*60*60*1e3));this.getBarPieEchartData(e+" 00:00:00",t+" 23:59:59")},methods:{setDate:function(){var t=new Date;t.setDate(t.getDate()),this.date=t.getFullYear()+"/"+s[t.getMonth()]+"/"+t.getDate()+" "+n[t.getDay()];var e=(new Date).getHours();this.hour=(e<10?"0":"")+e;var a=(new Date).getMinutes();this.min=(a<10?"0":"")+a;var i=(new Date).getSeconds();this.sec=(i<10?"0":"")+i},getLogsTotle:function(){var t=this;this.$get("/ecsCommon/getIndicesCount.do",{}).then(function(e){t.allLogsTotle=parseInt(e[0].indices).toLocaleString(),t.errorLogsTotle=parseInt(e[0].indiceserror).toLocaleString()}).catch(function(t){console.log(t)})},getFlowTotle:function(){var t=this;this.$get("/log/getIndicesCountByType.do",{}).then(function(e){t.flowTotle=parseInt(e[0].indices_defaultpacket).toLocaleString()}).catch(function(e){t.$Message.error(e)})},getLineEchartData:function(){var t=this,e=new Date,a=e.getMonth()+1,i=e.getDate();a<10&&(a="0"+(e.getMonth()+1)),i<10&&(i="0"+e.getDate());var s=e.getFullYear()+"-"+a+"-"+i;this.$nextTick(function(){t.$post("/ecsCommon/getLogCountGroupByTime.do",{starttime:s+" 00:00:00",endtime:s+" 23:59:59"}).then(function(e){var a=[];for(var i in e)a.push(e[i].count);t.echartData.lineData.xAxisArr=r,t.echartData.lineData.yAxisArr=a}).catch(function(t){console.log(t)})})},getBarPieEchartData:function(t,e){var a=this;this.loading=!0,this.$nextTick(function(){a.$post("/ecsCommon/getCountGroupByParam.do",{groupField:"log.level",starttime:t,endtime:e}).then(function(t){a.loading=!1;var e=t[0],i=[],s=[],n=[];for(var r in e){var l={};i.push(r),s.push(e[r]),l.value=e[r],l.name=r,n.push(l)}a.echartData.barData.xAxisArr=i,a.echartData.barData.yAxisArr=s,a.echartData.pieData.yAxisArr=n}).catch(function(t){a.loading=!1,console.log(t)})})},timeChange:function(){var t="",e="";""!==this.timeVal&&(t=Object(i.a)("yyyy-mm-dd",new Date),e=Object(i.a)("yyyy-mm-dd",new Date((new Date).getTime()-24*this.timeVal*60*60*1e3))),this.getBarPieEchartData(e+" 00:00:00",t+" 23:59:59")}},components:{vEcharts:a("jKHB").default}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-bg"},[a("div",{staticClass:"time-wapper"},[t._v(t._s(t.date)+" "+t._s(t.hour)+":"+t._s(t.min)+":"+t._s(t.sec))]),t._v(" "),a("div",{staticClass:"item-wapper",staticStyle:{"margin-top":"0",height:"auto"}},[a("div",{staticClass:"item-title"},[t._v("统计")]),t._v(" "),a("ul",{staticClass:"item-content",staticStyle:{padding:"0.45rem 0.8rem",height:"185px"}},[a("li",[a("div",{staticClass:"li-tit"},[t._v("日志数：")]),t._v(" "),a("div",{staticClass:"li-val"},[t._v(t._s(t.allLogsTotle))])]),t._v(" "),a("li",[a("div",{staticClass:"li-tit"},[t._v("error数：")]),t._v(" "),a("div",{staticClass:"li-val",staticStyle:{color:"#e4956d"}},[t._v(t._s(t.errorLogsTotle))])]),t._v(" "),a("li",[a("div",{staticClass:"li-tit"},[t._v("流量数：")]),t._v(" "),a("div",{staticClass:"li-val",staticStyle:{color:"#185bff"}},[t._v(t._s(t.flowTotle))])])])]),t._v(" "),a("div",{staticClass:"item-wapper"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.date.split(" ")[0])+" 数据量统计-折线图")]),t._v(" "),a("div",{staticClass:"item-content"},[a("v-echarts",{attrs:{echartType:"line",echartData:this.echartData.lineData}})],1)]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"item-wapper",attrs:{"element-loading-background":"rgba(48, 62, 78, 0.5)"}},[a("div",{staticClass:"item-title"},[t._v("日志级别数量统计\n      "),a("el-select",{staticClass:"select-list",attrs:{placeholder:"请选择",size:"mini"},on:{change:t.timeChange},model:{value:t.timeVal,callback:function(e){t.timeVal=e},expression:"timeVal"}},t._l(t.timeArr,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("div",{staticClass:"item-content"},[a("v-echarts",{attrs:{echartType:"bar",echartData:this.echartData.barData}})],1),t._v(" "),a("div",{staticClass:"item-content"},[a("v-echarts",{attrs:{echartType:"pie",echartData:this.echartData.pieData}})],1)])])},staticRenderFns:[]};var c=a("VU/8")(l,o,!1,function(t){a("Kos/")},"data-v-5d66b499",null);e.default=c.exports}});
//# sourceMappingURL=11.168d7fbc741b2751b0c7.js.map