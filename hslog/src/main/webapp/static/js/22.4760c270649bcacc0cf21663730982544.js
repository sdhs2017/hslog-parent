webpackJsonp([22],{"73bH":function(t,e){},ohVE:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("XLwt"),i=a.n(n),l=(a("PdmY"),a("9OQl"),a("jKHB")),o=a("oINY"),s=a("42rZ"),r=a("KxiM"),c=a("/sA3"),u=["01","02","03","04","05","06","07","08","09","10","11","12"],d=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],v={name:"flowIndex",data:function(){return{params:{intervalValue:"5",intervalType:"minute",starttime:"",endtime:"",last:"1-hour"},intervalObj:{state:!0,interval:"300000"},param2:{intervalValue:"5",intervalType:"second",starttime:"",endtime:"",last:"5-min"},param2IntervalObj:{state:!0,interval:"5000"},eData:[[{name:"jinan",value:[120.3719,36.0986]},{name:"jinan",value:[120.3719,36.0986]}],[{name:"jinan",value:[120.3719,36.0986]},{name:"Hangzhou",value:[120.1619,30.294]}],[{name:"jinan",value:[120.3719,36.0986]},{name:"Singapore",value:[103.8547,1.2929]}],[{name:"jinan",value:[120.3719,36.0986]},{name:"Beijing",value:[116.3889,39.9288]}],[{name:"jinan",value:[120.3719,36.0986]},{name:"Tokyo",value:[139.7532,35.6882]}],[{name:"jinan",value:[120.3719,36.0986]},{name:"Mountain View",value:[-122.0748,37.4043]}],[{name:"jinan",value:[120.3719,36.0986]},{name:"Central",value:[114.15,22.2909]}],[{name:"jinan",value:[120.3719,36.0986]},{name:"Seattle",value:[-122.3451,47.6348]}],[{name:"jinan",value:[120.3719,36.0986]},{name:"Qingdao",value:[120.3694,36.066]}],[{name:"jinan",value:[120.3719,36.0986]},{name:"Ashburn",value:[-77.4728,39.0481]}],[{name:"Hangzhou",value:[120.1619,30.294]},{name:"jinan",value:[120.3719,36.0986]}],[{name:"Mountain View",value:[-122.0748,37.4043]},{name:"jinan",value:[120.3719,36.0986]}],[{name:"Beijing",value:[116.3889,39.9288]},{name:"jinan",value:[120.3719,36.0986]}],[{name:"Singapore",value:[103.8547,1.2929]},{name:"jinan",value:[120.3719,36.0986]}],[{name:"Central",value:[114.15,22.2909]},{name:"jinan",value:[120.3719,36.0986]}],[{name:"Tokyo",value:[139.7532,35.6882]},{name:"jinan",value:[120.3719,36.0986]}],[{name:"Seattle",value:[-122.3451,47.6348]},{name:"jinan",value:[120.3719,36.0986]}],[{name:"Ashburn",value:[-77.4728,39.0481]},{name:"jinan",value:[120.3719,36.0986]}],[{name:"San Francisco",value:[-122.4121,37.7506]},{name:"jinan",value:[120.3719,36.0986]}]],option:{},interTime:"",timeInterval:3e5,dataTime:3600,fullscreen:!1,date:"",hour:"",min:"",sec:"",currentMouth:"",flowCount:"",chartData1:{baseConfig:{title:"",xAxisName:"资产\nIP",yAxisName:"数据包个数/个",hoverText:"",rotate:"20",itemColor:["rgba(68,47,148,0.5)","rgba(15,219,243,1)"]},xAxisArr:[],yAxisArr:[]},rankingData:[],chartData2:{baseConfig:{title:"",xAxisName:"时间",yAxisName:"数据包长度/KB",hoverText:""},yAxisArr:[{name:"",color:"rgb(15,219,243)",data:[]}]},chartData3:{baseConfig:{title:"",xAxisName:"",yAxisName:"",hoverText:""},xAxisArr:[],yAxisArr:[]}}},created:function(){setInterval(this.setDate,1e3);var t=navigator.userAgent,e=!t.match(/(iPad).*OS\s([\d_]+)/)&&t.match(/(iPhone\sOS)\s([\d_]+)/),a=t.match(/(Android)\s+([\d.]+)/);(e||a)&&this.$router.push("/mobile/flowIndex_m")},mounted:function(){var t=this;this.setEarth(),this.getFlowCount();var e=Object(c.e)("yyyy-mm-dd",new Date).split("-");e[0],e[1];this.currentMouth=e[1],this.getRanklingData(),this.interTime=setInterval(function(){t.getFlowCount(),t.getRanklingData()},this.timeInterval)},methods:{setDate:function(){var t=new Date;t.setDate(t.getDate()),this.date=t.getFullYear()+"/"+u[t.getMonth()]+"/"+t.getDate()+" "+d[t.getDay()];var e=(new Date).getHours();this.hour=(e<10?"0":"")+e;var a=(new Date).getMinutes();this.min=(a<10?"0":"")+a;var n=(new Date).getSeconds();this.sec=(n<10?"0":"")+n},handleFullScreen:function(){var t=document.getElementById("flow-index-wapper");this.fullscreen?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen():t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen(),this.fullscreen=!this.fullscreen},setOpt:function(t){var e=this;this.$nextTick(function(){layer.load(1),e.$axios.get(e.$baseUrl+"/flow/getMap.do","").then(function(t){layer.closeAll("loading");var a=[];t.data.forEach(function(t,e){a.push({type:"lines3D",effect:{show:!0,period:3,trailLength:.1},lineStyle:{color:"#9ae5fc",width:1,opacity:.6},data:[[t[0].value,t[1].value]]}),a.push({type:"scatter3D",coordinateSystem:"globe",blendMode:"lighter",symbolSize:10,label:{show:!0,formatter:function(e){return t[0].name},textStyle:{color:"blue",fontSize:"12"}},itemStyle:{color:"rgb(255,0,0)",opacity:1},data:[[t[0].value[0],t[0].value[1],0]]}),a.push({type:"scatter3D",coordinateSystem:"globe",blendMode:"lighter",symbolSize:10,label:{show:!0,formatter:function(e){return t[0].name},textStyle:{color:"blue",fontSize:"12"}},itemStyle:{color:"rgb(255,0,0)",opacity:1},data:[[t[1].value[0],t[1].value[1],0]]})}),e.option={backgroundColor:"rgba(0,0,0,0)",globe:{baseTexture:"./static/img/world.png",top:"middle",left:"center",displacementScale:0,environment:"none",shading:"color",viewControl:{distance:240,autoRotate:!1,autoRotateAfterStill:5,targetCoord:[116.46,39.92]}},series:a}}).catch(function(t){layer.closeAll("loading")})})},setEarth:function(){var t=this;this.$nextTick(function(){t.$axios.post(t.$baseUrl+"/flow/getMap.do",t.$qs.stringify({timeInterval:86400})).then(function(e){var a=[];e.data.forEach(function(t,e){a.push({type:"lines3D",effect:{show:!0,period:3,trailLength:.1},lineStyle:{color:"#9ae5fc",width:1,opacity:.6},data:[[t[0].value,t[1].value]]}),a.push({type:"scatter3D",coordinateSystem:"globe",blendMode:"lighter",symbolSize:10,label:{show:!0,formatter:function(e){return t[0].name},textStyle:{color:"blue",fontSize:"12"}},itemStyle:{color:"rgb(255,0,0)",opacity:1},data:[[t[0].value[0],t[0].value[1],0]]}),a.push({type:"scatter3D",coordinateSystem:"globe",blendMode:"lighter",symbolSize:10,label:{show:!0,formatter:function(e){return t[1].name},textStyle:{color:"blue",fontSize:"12"}},itemStyle:{color:"rgb(255,0,0)",opacity:1},data:[[t[1].value[0],t[1].value[1],0]]})}),t.option={backgroundColor:"rgba(0,0,0,0)",globe:{baseTexture:"./static/img/world.png",top:"middle",left:"center",displacementScale:0,environment:"none",shading:"color",viewControl:{distance:240,autoRotate:!1,autoRotateAfterStill:5,targetCoord:[116.46,39.92]}},series:a};var n=i.a.init(t.$refs.mybox);n.setOption(t.option,!0),window.addEventListener("resize",function(){n.resize()})}).catch(function(t){layer.closeAll("loading")})})},setEarth2:function(){var t=this;this.$nextTick(function(){layer.load(1),t.$axios.get(t.$baseUrl+"/flow/getMap.do","").then(function(e){layer.closeAll("loading");var a=[],n=[];e.data.forEach(function(t,e){n.push({type:"effectScatter",coordinateSystem:"geo",zlevel:3,rippleEffect:{brushType:"stroke"},label:{fontSize:18,show:!0,position:"right",formatter:"{b}"},itemStyle:{normal:{color:"#f5f802"}},data:[{name:t[0].name,value:t[0].value,symbolSize:10,label:{normal:{position:"right"}}}]},{type:"effectScatter",coordinateSystem:"geo",zlevel:3,rippleEffect:{brushType:"stroke"},label:{normal:{show:!0,position:"left",fontSize:18,formatter:"{b}"}},itemStyle:{normal:{color:"#f5f802"}},data:[{name:t[1].name,value:t[1].value,symbolSize:10,label:{normal:{position:"right"}}}]}),a.push({type:"lines3D",effect:{show:!0,period:3,trailLength:.1},lineStyle:{color:"#9ae5fc",width:1,opacity:.6},data:[[t[0].value,t[1].value]]})});var l=document.createElement("canvas"),o=i.a.init(l,null,{width:4096,height:2048});o.setOption({backgroundColor:"rgba(3,28,72,0.3)",title:{show:!0},geo:{type:"map",map:"world",left:0,top:0,right:0,bottom:0,boundingCoords:[[-180,90],[180,-90]],zoom:0,roam:!1,itemStyle:{borderColor:"#000d2d",normal:{areaColor:"#2455ad",borderColor:"#000c2d"},emphasis:{areaColor:"#357cf8"}},emphasis:{label:{show:!1}},label:{fontSize:24}},series:n});var s={backgroundColor:"rgba(0,0,0,0)",globe:{baseTexture:o,top:"middle",left:"center",displacementScale:0,environment:"none",shading:"color",viewControl:{distance:240,autoRotate:!1,autoRotateAfterStill:5,targetCoord:[116.46,39.92]}},series:a},r=i.a.init(t.$refs.mybox);r.setOption(s,!0),window.addEventListener("resize",function(){r.resize()})}).catch(function(t){layer.closeAll("loading")})})},getFlowCount:function(){var t=this;this.$nextTick(function(){t.$axios.post(t.$baseUrl+"/log/getIndicesCountByType.do",{}).then(function(e){t.flowCount=parseInt(e.data[0].indices_defaultpacket).toLocaleString()}).catch(function(t){console.log(t)})})},getDataByTime:function(t){var e=this;this.$nextTick(function(){e.$axios.post(e.$baseUrl+"/flow/getPacketLengthPerSecond.do",e.$qs.stringify({timeInterval:t})).then(function(t){e.chartData2.yAxisArr[0].data.length<60?e.chartData2.yAxisArr[0].data.push(t.data[0]):(e.chartData2.yAxisArr[0].data.shift(),e.chartData2.yAxisArr[0].data.push(t.data[0]))}).catch(function(t){})})},getIpPacketsData:function(t){var e=this;this.$nextTick(function(){e.$axios.post(e.$baseUrl+"/flow/getDstIPPacketCount.do",e.$qs.stringify({timeInterval:t})).then(function(t){layer.closeAll("loading");var a=[],n=[],i=[];for(var l in t.data){var o=t.data[l];for(var s in o)a.push(s),n.push(o[s]),i.push({name:s,value:o[s]})}e.chartData1.xAxisArr=a,e.chartData1.yAxisArr=n}).catch(function(t){layer.closeAll("loading")})})},getTargetPortFlowData:function(t){var e=this;this.$nextTick(function(){e.$axios.post(e.$baseUrl+"/flow/getDstPortCount.do",e.$qs.stringify({timeInterval:t})).then(function(t){layer.closeAll("loading");var a=[],n=[],i=[];for(var l in t.data){var o=t.data[l];for(var s in o)a.push(s),n.push(o[s]),i.push({name:s,value:o[s]})}e.chartData3.yAxisArr=i}).catch(function(t){layer.closeAll("loading")})})},getRanklingData:function(){var t=this;this.$nextTick(function(){t.$axios.post(t.$baseUrl+"/flow/getCountGroupByUrl.do",t.$qs.stringify({timeInterval:3600})).then(function(e){layer.closeAll("loading");var a=[];e.data.forEach(function(t){var e={};e.val=t.domain_url,e.num=t.count,a.push(e)}),t.rankingData=a}).catch(function(t){layer.closeAll("loading")})})}},beforeDestroy:function(){clearInterval(this.interTime)},components:{vEcharts:l.default,eqIpPacket_bar:o.default,dstPortAll_pie:s.default,allflow_timeline:r.default}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flow-index-wapper",attrs:{id:"flow-index-wapper"}},[a("i",{staticClass:"el-icon-rank fullScreen",on:{click:t.handleFullScreen}}),t._v(" "),a("h2",{staticClass:"index-tit"},[t._v("流量分析系统 ")]),t._v(" "),a("div",{ref:"mybox",staticClass:"world-wapper",attrs:{id:"world-wapper"}}),t._v(" "),a("el-row",{staticClass:"index-con",attrs:{gutter:20}},[a("el-col",{staticClass:"item-col",attrs:{span:7}},[a("div",{staticClass:"item"},[a("div",{staticClass:"item-con"},[a("div",{staticClass:"con-tit"},[t._v("资产（IP）数据包个数")]),t._v(" "),a("div",{staticClass:"con",staticStyle:{padding:"0 10px"}},[a("eqIpPacket_bar",{attrs:{params:t.params,setIntervalObj:t.intervalObj}})],1)]),t._v(" "),a("div",{staticClass:"item-con ranking"},[a("div",{staticClass:"con-tit"},[t._v(" URL 排行榜")]),t._v(" "),a("div",{staticClass:"con"},[a("div",{staticClass:"ranking-head"},[a("span",{staticClass:"order"},[t._v("#")]),t._v(" "),a("span",{staticClass:"val"},[t._v("URL")]),t._v(" "),a("span",{staticClass:"num"},[t._v("数量")])]),t._v(" "),a("ul",{staticClass:"ranking-ul"},t._l(t.rankingData,function(e,n){return a("li",{key:n,class:0===n?"first-li":1===n?"second-li":2===n?"third-li":""},[a("span",{staticClass:"order"},[t._v(t._s(n+1))]),t._v(" "),a("span",{staticClass:"val",attrs:{title:e.val}},[t._v(t._s(e.val))]),t._v(" "),a("span",{staticClass:"num"},[t._v(t._s(e.num>1e4?(e.num/1e4).toFixed(2)+"万":e.num))])])}),0)])])])]),t._v(" "),a("el-col",{staticClass:"item-col",attrs:{span:10}},[a("div",{staticClass:"item center"},[a("div",{staticClass:"current-date"},[a("div",{attrs:{id:"date"}},[t._v(t._s(t.date))]),t._v(" "),a("ul",[a("li",{attrs:{id:"hours"}},[t._v(" "+t._s(t.hour))]),t._v(" "),a("li",{staticClass:"point"},[t._v(":")]),t._v(" "),a("li",{attrs:{id:"min"}},[t._v(t._s(t.min)+" ")]),t._v(" "),a("li",{staticClass:"point"},[t._v(":")]),t._v(" "),a("li",{attrs:{id:"sec"}},[t._v(" "+t._s(t.sec))])])]),t._v(" "),a("div",{staticClass:"item-con flow-count-wapper"},[a("p",{staticClass:"flow-count-tit"},[t._v("已收集流量数")]),t._v(" "),a("p",{staticClass:"flow-count-con"},t._l(t.flowCount,function(e,n){return","!==e?a("span",{key:n},[t._v(t._s(e))]):a("b",[t._v(t._s(e))])}),0)])])]),t._v(" "),a("el-col",{staticClass:"item-col",attrs:{span:7}},[a("div",{staticClass:"item"},[a("div",{staticClass:"item-con"},[a("div",{staticClass:"con-tit"},[t._v("实时流量数据访问包大小")]),t._v(" "),a("div",{staticClass:"con"},[a("allflow_timeline",{attrs:{params:t.param2,setIntervalObj:t.param2IntervalObj,baseConProp:{title:""}}})],1)]),t._v(" "),a("div",{staticClass:"item-con"},[a("div",{staticClass:"con-tit"},[t._v("目的端口总流量")]),t._v(" "),a("div",{staticClass:"con"},[a("dstPortAll_pie",{attrs:{params:t.params,setIntervalObj:t.intervalObj}})],1)])])])],1)],1)},staticRenderFns:[]};var f=a("VU/8")(v,m,!1,function(t){a("73bH")},"data-v-f1b0b56a",null);e.default=f.exports}});